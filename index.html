<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TerraShield Agriculture Insurance</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<style>
:root {
  --gold: #E3A008;
  --dark-gold: #D97706;
  --light-cream: #FFF8E5;
  --text-dark: #2C2A29;
  --bg: #FFFCF7;
}

/* ====== Global Base ====== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Poppins', sans-serif;
}

html { scroll-behavior: smooth; }
body { background: var(--bg); color: var(--text-dark); }

header {
  background: linear-gradient(90deg, var(--gold), var(--dark-gold));
  color: white;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 10;
}

.logo-box { display: flex; align-items: center; gap: 10px; }
.logo { height: 48px; width: auto; }
header h1 { font-size: 1.3rem; letter-spacing: .5px; }

nav a {
  color: white;
  text-decoration: none;
  margin-left: 1.2rem;
  font-weight: 500;
  position: relative;
  padding-bottom: 4px;
  transition: color 0.3s ease;
}
nav a:hover { color: var(--light-cream); }
nav a.active {
  color: var(--light-cream);
  font-weight: 600;
}
nav a.active::after {
  content: "";
  position: absolute;
  left: 0; bottom: 0;
  width: 100%; height: 2px;
  background: var(--light-cream);
}

/* ===== Hero Section ===== */
.hero {
  background: linear-gradient(to right, #FFF7E0, #FFF8E5);
  text-align: center;
  padding: 4rem 1rem 3rem;
}
.hero h2 { font-size: 2.2rem; color: var(--dark-gold); }
.slogan {
  font-style: italic;
  color: var(--dark-gold);
  font-size: 1.5rem;
  font-weight: 500;
  margin-top: .3rem;
  margin-bottom: 1rem;
  opacity: 0;
  transform: translateY(10px);
  animation: fadeInSlogan 1.8s ease forwards;
  animation-delay: .5s;
}
@keyframes fadeInSlogan { to { opacity: 1; transform: translateY(0); } }
.sub-brand {
  font-size: .95rem;
  color: #8b6b2e;
  font-style: italic;
  margin-top: .5rem;
  margin-bottom: 1.2rem;
  opacity: 0;
  transform: translateY(8px);
  animation: fadeInSub 1.6s ease forwards;
  animation-delay: .6s;
  border-top: 1px solid #f3e1b2;
  display: inline-block;
  padding-top: .4rem;
}
@keyframes fadeInSub {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}


/* ===== Containers ===== */
.container {
  max-width: 900px;
  background: white;
  margin: 3rem auto;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.08);
}
h3 { text-align: center; color: var(--dark-gold); margin-bottom: 1.2rem; }

/* ===== Premium Calculator Grid ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 1rem;
}
label { display: block; font-size: .9rem; margin-bottom: .3rem; }
select, input {
  width: 100%;
  padding: .8rem;
  border-radius: 6px;
  border: 1px solid #ddd;
}
button {
  display: block;
  background: var(--dark-gold);
  color: white;
  border: none;
  margin: 1.5rem auto 0;
  padding: .9rem 2.2rem;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.05rem;
}
button:hover {
  background: var(--gold);
  transform: translateY(-2px);
  transition: .2s;
}

/* ===== Result Box ===== */
#resultBox {
  display: none;
  background: var(--light-cream);
  text-align: center;
  margin-top: 1rem;
  padding: 1rem;
  border-radius: 8px;
  color: var(--dark-gold);
  font-weight: 500;
}

/* ===== Promo Card ===== */
.promo-card {
  max-width: 900px;
  margin: 2.5rem auto;
  background: #ffffff;
  border: 1px solid #f1e1bd;
  border-radius: 12px;
  padding: 1.4rem 1.8rem;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
}
.promo-card:hover {
  box-shadow: 0 5px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-2px);
}
.promo-display {
  display: flex;
  justify-content: space-between;   /* Â∑¶ÊñáÂ≠óÂè≥ÊåâÈíÆ */
  align-items: baseline;            /* ‚úÖ ÂØπÈΩêÂà∞ÊñáÂ≠óÁöÑÂ∫ïÁ∫ø */
  padding: 0.9rem 1.2rem;
}

.promo-text {
  color: #4b3b08;
  font-weight: 600;
  font-size: 1.05rem;
  line-height: 1.4;                 /* ‚úÖ Á°Æ‰øùÊñáÂ≠óÊúâÊ†áÂáÜË°åÈ´ò */
}

.promo-edit-btn {
  background: #fff8e5;
  border: 2px solid #d97706;
  color: #d97706;
  font-weight: 700;
  font-size: 0.95rem;
  padding: 0.55rem 1.4rem;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  position: relative;
  top: -1px;                        /* ‚úÖ ÂæÆË∞ÉÔºå‰ΩøÊåâÈíÆ‰∏éÊñáÂ≠ó‰∏≠ÂøÉÂÆåÁæéÂØπÈΩê */
  transition: all 0.25s ease;
}
.promo-edit-btn:hover {
  background: var(--dark-gold);
  color: #fff;
}
.promo-banner {
  display: none;
  background: #ebf7ee;               /* ÊüîÂíåÁªøÂ∫ï */
  border-left: 5px solid #16a34a;    /* Ê∑±ÁªøÁ∫ø */
  border-radius: 6px;
  padding: 0.75rem 1rem;
  margin-top: 1.2rem;
  color: #166534;
  font-weight: 500;
  animation: fadeInPromo 0.5s ease;
}
/* ===== Coverage / Overview Section ===== */
#overview,
#coverage-preview {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;               /* ‚úÖ ÊñáÊú¨Â∑¶ÂØπÈΩê */
}
#coverage-preview { background: #fff9ee; } /* ‰øùÊåÅÊ∑°ÈªÑËâ≤ËÉåÊôØ */
/* ‚úÖ ËÆ©ÊåâÈíÆÂ±Ö‰∏≠ */
#coverage-preview {
  text-align: center; /* Áà∂ÂÆπÂô®Â±Ö‰∏≠ÔºåÊåâÈíÆËá™Âä®Â±Ö‰∏≠ */
}

#coverage-preview p {
  text-align: left; /* ÊÆµËêΩ‰ªçÁÑ∂Â∑¶ÂØπÈΩê */
}
#overview h3,
#coverage-preview h3 {
  text-align: center;
  margin-bottom: 1rem;
}
#overview p,
#coverage-preview p {
  font-size: 1rem;
  line-height: 1.75;
  margin: 0 0 1.5rem 0;
  letter-spacing: 0.3px;
  word-spacing: 1px;
}
#coverage-preview .coverage-btn {
  display: inline-block;
  margin: 0 auto;
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 0.7rem 1.6rem;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 500;
  transition: background 0.3s ease;
}
#coverage-preview .coverage-btn:hover { background: var(--gold); }

/* ===== Contact Section ===== */
#contact {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;
}
/* Force the disclaimer container to left-align */
.disclaimer-bar {
  text-align: left !important;   /* ‚úÖ Áà∂Á∫ßÂº∫Âà∂Â∑¶ÂØπÈΩê */
}
  
/* ===== Disclaimer  ===== */
.disclaimer-bar p {
  font-family: 'Poppins', sans-serif;
  font-style: italic;
  font-size: 0.9rem;
  line-height: 1.6;
  color: var(--dark-gold);
  text-align: left;
  margin-top: 1.5rem;
  margin-bottom: 0;
}

/* ===== Footer ===== */
footer {
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 1.2rem;
  margin-top: 4rem;
  font-size: 0.9rem;
}

/* ===== Responsive ===== */
@media(max-width:600px) {
  header { flex-direction: column; align-items: flex-start; }
  .container { padding: 1.5rem; }
  #overview, #coverage-preview, #contact, .promo-card { padding: 1.5rem; }
  .hero h2 { font-size: 1.7rem; }
  .disclaimer-bar p { font-size: 0.8rem; }
}
/* ===== Promo Edit / Input layout ===== */
.promo-edit {
  padding: 0.9rem 1.2rem;
  border-top: 1px solid #f0e3c4;
  border-radius: 8px;
  background: #fffdf8;
  margin-top: 0.8rem;
}

.promo-edit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  color: var(--dark-gold);
  font-weight: 600;
}

.promo-input-row {
  display: flex;
  gap: 0.8rem;
}

.promo-input-row input {
  flex: 1;
  padding: 0.75rem;
  font-size: 0.95rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  color: #333;
}

.promo-input-row input:focus {
  outline: none;
  border-color: var(--dark-gold);
  box-shadow: 0 0 3px rgba(217, 119, 6, 0.3);
}

.promo-apply,
.promo-cancel {
  background: var(--dark-gold);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.65rem 1.2rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s ease;
}

.promo-apply:hover,
.promo-cancel:hover {
  background: var(--gold);
}

.promo-message {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  font-weight: 500;
}

.arrow {
  font-weight: 500;
  color: #7a621f;
  margin: 0 4px;
}
/* ===== Promo Discount Styling ===== */
.old-price {
  text-decoration: line-through;
  color:  #9ca3af;            /* ÁÅ∞Ëâ≤ */
  margin-right: 0.5rem;
  opacity: 0.8;
}

.new-price {
  color: #166534;            /* ÁªøËâ≤‰ª£Ë°®ËäÇÁúÅ */
  font-weight: 700;
}
/* ===== Highlight Total Premium Line ===== */
.highlight-total {
  background-color: #fff8e1;
  border-radius: 8px;
  padding: 0.7rem 1.2rem;
  margin-top: 0.8rem;
  display: inline-block;
  font-weight: 700;
  color: #b45309;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  font-size: 1rem;
  text-align: center;
  transition: background-color 0.3s ease, transform 0.3s ease;
}
#resultBox .highlight-total {
  display: block;
  width: fit-content;
  margin: 0.8rem auto;
}
.highlight-total:hover {
  background-color: #ffefc6;
  transform: scale(1.03);
}

/* ===== Promo ËØ¥ÊòéË°åÔºàÊ∑°ÂÖ•Âä®ÊïàÔºâ ===== */
#resultBox .discount-note {
  margin-top: 0.6rem;
  font-size: 0.9rem;
  color: #166534 !important;   /* Ê∑±ÁªøËâ≤ */
  font-weight: 500;
  opacity: 0;                   /* Ëµ∑ÂßãÈÄèÊòé */
  transform: translateY(6px);   /* Ëµ∑ÂßãÂæÆ‰∏ãÁßª */
  animation: fadeInUp 0.6s ease forwards;
}

/* Hover ËΩªËâ≤ÂèòÂåñ */
#resultBox .discount-note:hover {
  color: #0f5132 !important;
}

/* Âä®ÁîªÂÖ≥ÈîÆÂ∏ß */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
  
</head>

<body>
<div id="site-header"></div>

<section class="hero">
  <h2>Protecting‚ÄØFarmers,‚ÄØSecuring‚ÄØHarvests</h2>
  <h3 class="slogan">‚ÄúLebih‚ÄØPasti,‚ÄØLebih‚ÄØTenang‚Äù</h3>
  <p class="sub-brand">Powered‚ÄØby‚ÄØ<strong>AgroShield‚ÄØIncome‚ÄØGuard</strong> ‚Äî An‚ÄØIncome‚ÄØProtection‚ÄØPlan‚ÄØby‚ÄØTerraShield‚ÄØInsurance</p>
  <p>Estimate‚ÄØ your‚ÄØ agricultural‚ÄØ insurance‚ÄØ premium‚ÄØ instantly‚ÄØ for‚ÄØ your‚ÄØ crops‚ÄØ in‚ÄØ Malaysia.</p>
</section>

  
<section id="calculator" class="container">
  <h3>Premium Calculator</h3>
  <div class="grid">
    <div>
      <label for="state">State</label>
      <select id="state" onchange="updateCoverageOptions()">
        <option value="">-- Select State --</option>
        <option>Johor</option><option>Kedah</option><option>Kelantan</option><option>Melaka</option>
        <option>Negeri Sembilan</option><option>Pahang</option><option>Perak</option><option>Perlis</option>
        <option>Pulau Pinang</option><option>Sabah</option><option>Sarawak</option><option>Selangor</option>
        <option>Terengganu</option><option>W.P. Kuala Lumpur</option><option>W.P Labuan</option><option>W.P. Putrajaya</option>
      </select>
    </div>
    <div>
      <label for="district">District</label>
      <input id="district" placeholder="e.g. Kota Setar" />
    </div>
    <div>
      <label for="crop">Crop</label>
      <select id="crop" onchange="updateCoverageOptions()">
        <option value="">-- Select Crop --</option>
        <option>Oil Palm</option><option>Rubber</option>
        <option>Cocoa</option><option>Durian</option><option>Coconut</option>
        <option>Pineapple</option><option>Mango</option>
      </select>
    </div>
    <!-- ‚úÖ ÁßªÈô§‰∫Ü Expected Yield -->
    <div>
      <label for="area">Area (ha)</label>
      <input id="area" type="number" value="10" step="0.1" />
    </div>
    <div>
      <label for="trigger">Trigger Level</label>
      <select id="trigger" onchange="updateCoverageLevel()">
        <option value="">Select crop/state first</option>
      </select>
    </div>
    <div>
      <label for="coverage">Coverage Level</label>
      <input id="coverage" type="text" readonly placeholder="Auto‚Äëcalculated" />   
    </div>
    <p style="font-size:0.9rem;color:#8b6b2e;margin-top:0.5rem;
               display:flex;align-items:center;gap:8px;
               letter-spacing:0.5px;word-spacing:1px;line-height:1.7;">
      <span style="font-size:1.1rem;">üí°</span>
      <span>
        Coverage‚ÄØis‚ÄØalways‚ÄØ<strong>20%‚ÄØhigher</strong>‚ÄØthan‚ÄØthe‚ÄØtrigger‚ÄØlevelÔºå
        this‚ÄØmeans‚ÄØonce‚ÄØyour‚ÄØloss‚ÄØreaches‚ÄØthe‚ÄØtrigger‚ÄØpoint,‚ÄØTerraShield‚ÄØwill‚ÄØcover‚ÄØup‚ÄØto‚ÄØ20%‚ÄØmore‚ÄØto‚ÄØprotect‚ÄØyou‚ÄØbetter.
      </span>
    </p>
  </div>
  <button onclick="calculatePremium()">Calculate</button>
  <div id="promoNotice" class="promo-banner">
    <span id="promoNoticeText"></span>
  </div>
  <div id="resultBox"></div>
  <div class="disclaimer-bar">
  <p>
  The above premiums are calculated at the standard premium rate and are for reference only.
  The actual premiums paid must include the premium levy collected by the Insurance Authority.
  </p>
  </div>

</section>
<!-- Promo Section -->
<div id="promoContainer" class="promo-card">
  <!-- Â±ïÁ§∫Ê®°Âºè -->
  <div id="promoDisplay" class="promo-display">
    <div class="promo-text">
      <span id="promoStatusText">No promotion code applied.</span>
    </div>
    <button class="promo-edit-btn" onclick="togglePromoEdit(true)">Edit Promo Code</button>
  </div>

  <!-- ÁºñËæëÊ®°Âºè -->
  <div id="promoEdit" class="promo-edit" style="display:none;">
    <div class="promo-edit-header">
      <span>Enter your Promotion Code</span>
    </div>
    <div class="promo-input-row">
      <input id="promoInput" placeholder="e.g.‚ÄØWELCOME" />
      <button class="promo-apply" onclick="applyPromo()">Apply</button>
    </div>
    <div id="promoMessage" class="promo-message"></div>
  </div>
</div>
  
<!-- ‚¨áÔ∏è ÊîæÂú® Footer ‰∏äÊñπ -->
<section id="overview" class="container">
  <h3>About‚ÄØTerraShield</h3>
  <p>
    TerraShield empowers Malaysian farmers‚ÄØwith reliable,‚ÄØdata‚Äëdriven‚ÄØinsurance tools to make crop protection‚ÄØ
    transparent and‚ÄØaffordable for‚ÄØsustainable‚ÄØgrowth.
  </p>
</section>

<section id="coverage-preview" class="container coverage-preview">
  <h3>Crop‚ÄØ&‚ÄØRisk‚ÄØCoverage‚ÄØOverview</h3>
  <p>
    Learn which crops and‚ÄØrisks are included in our‚ÄØMalaysian‚ÄØAgricultural‚ÄØInsurance Program¬†‚Äî from rice, 
    durian,‚ÄØand oil palm to‚ÄØprotection‚ÄØfrom floods,‚ÄØdroughts, and‚ÄØtyphoons.
  </p>
  <a class="coverage-btn" href="./coverage.html">View‚ÄØFull‚ÄØCoverage¬†‚Üí</a>
</section>

<section id="contact" class="container">
  <h3>Contact‚ÄØUs</h3>
  <p>
    Email:‚ÄØ<a href="mailto:info@terrashield.my">info@terrashield.my</a><br/>
    Kuala‚ÄØLumpur,‚ÄØMalaysia
  </p>
</section>

<footer>¬©‚ÄØ2025‚ÄØTerraShield‚ÄØAgriculture‚ÄØInsurance‚ÄØ|‚ÄØAll‚ÄØRights‚ÄØReserved</footer>

<script>
fetch('./header.html?v=20251125')
  .then(r=>r.text())
  .then(h=>{document.getElementById('site-header').innerHTML=h;
    const p=location.pathname.split("/").pop()||"index.html";
    document.querySelectorAll("nav a").forEach(a=>{if(a.href.includes(p))a.classList.add("active");});
  }).catch(console.error);

/* ===== Coverage limits (for dropdown) ===== */
const coverageLimits = {
  "Oil Palm": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Durian": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,80], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Rubber": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Selangor":[50,70], "Terengganu":[50,70],
    "Sabah":[50,80], "Sarawak":[50,80], "W.P. Kuala Lumpur":[50,70],
    "W.P Labuan":[50,70], "W.P. Putrajaya":[50,70]
  },

  "Pineapple": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,90],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Cocoa": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Coconut": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Mango": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  }
};

/* === ÂÖ®ÈÉ®‰ΩúÁâ©ÁöÑ Gross Premium Ë°®Ê†º === */
const grossPremiumTable = {
  "Cocoa": {
      "Johor": {"70": 55.29, "75": 70.57, "80": 88.84, "85": 110.01, "90": 133.89},
      "Kedah": {"70": 55.11, "75": 70.3, "80": 88.48, "85": 109.53, "90": 133.29, "95": 159.56, "100": 188.16, "100": 196.47, "100": 202.17},
      "Kelantan": {"70": 55.29, "75": 70.57, "80": 88.84, "85": 110.01, "90": 133.89},
      "Melaka": {"70": 55.26, "75": 70.52, "80": 88.78, "85": 109.92, "90": 133.78},
      "Negeri Sembilan": {"70": 55.26, "75": 70.52, "80": 88.78, "85": 109.92, "90": 133.78},
      "Pahang": {"70": 55.63, "75": 71.05, "80": 89.5, "85": 110.87, "90": 134.98},
      "Perak": {"70": 55.11, "75": 70.3, "80": 88.48, "85": 109.53, "90": 133.29, "95": 159.56, "100": 188.16, "100": 196.47, "100": 202.17},
      "Perlis": {"70": 55.26, "75": 70.52, "80": 88.78, "85": 109.92, "90": 133.78},
      "Pulau Pinang": {"70": 55.6, "75": 71, "80": 89.43, "85": 110.78, "90": 134.86},
      "Sabah": {"70": 55.97, "75": 71.53, "80": 90.16, "85": 111.73, "90": 136.07, "95": 162.99, "100": 192.28},
      "Sarawak": {"70": 55.78, "75": 71.27, "80": 89.8, "85": 111.25, "90": 135.47, "95": 162.25, "100": 191.39},
      "Selangor": {"70": 55.44, "75": 70.78, "80": 89.14, "85": 110.39, "90": 134.38},
      "Terengganu": {"70": 55.29, "75": 70.57, "80": 88.84, "85": 110.01, "90": 133.89},
      "W.P Labuan": {"70": 55.6, "75": 71, "80": 89.43, "85": 110.78, "90": 134.86},
      "W.P. Kuala Lumpur": {"70": 55.6, "75": 71, "80": 89.43, "85": 110.78, "90": 134.86},
      "W.P. Putrajaya": {"70": 55.6, "75": 71, "80": 89.43, "85": 110.78, "90": 134.86}
      },
  "Coconut": {
      "Johor": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.7},
      "Kedah": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.67, "95": 49, "100": 124.29, "100": 245.12, "100": 392.93},
      "Kelantan": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.7},
      "Melaka": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.69},
      "Negeri Sembilan": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.69},
      "Pahang": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.75},
      "Perak": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.67, "95": 49, "100": 124.29, "100": 245.12, "100": 392.93},
      "Perlis": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.69},
      "Pulau Pinang": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.75},
      "Sabah": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.81, "95": 49.71, "100": 126.84},
      "Sarawak": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.78, "95": 49.55, "100": 126.29},
      "Selangor": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.72},
      "Terengganu": {"70": 20, "75": 20, "80": 20.05, "85": 20.72, "90": 25.7},
      "W.P Labuan": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.75},
      "W.P. Kuala Lumpur": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.75},
      "W.P. Putrajaya": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.75}
      },
  "Durian": {
      "Johor": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.26},
      "Kedah": {"70": 20, "75": 20, "80": 20.03, "85": 20.9, "90": 34.18, "95": 142.63, "100": 673.26, "100": 1875.94, "100": 3700.29},
      "Kelantan": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.4},
      "Melaka": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.24},
      "Negeri Sembilan": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.24},
      "Pahang": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.4},
      "Perak": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.46, "95": 144.99, "100": 685.82},
      "Perlis": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.24},
      "Pulau Pinang": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.24},
      "Sabah": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.53, "95": 145.64, "100": 689.29},
      "Sarawak": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.46, "95": 144.99, "100": 685.82},
      "Selangor": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.32},
      "Terengganu": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.26},
      "W.P Labuan": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.38},
      "W.P. Kuala Lumpur": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.38},
      "W.P. Putrajaya": {"70": 20, "75": 20, "80": 20.03, "85": 20.92, "90": 34.38}
      },
  "Mango": {
      "Johor": {"70": 1705.85, "75": 2346.23, "80": 3090.95, "85": 3933.87, "90": 4868.11},
      "Kedah": {"70": 1696.94, "75": 2333.94, "80": 3074.72, "85": 3913.2, "90": 4842.5, "95": 5855.49, "100": 6945.12, "100": 7232.6, "100": 7427.75},
      "Kelantan": {"70": 1705.85, "75": 2346.23, "80": 3090.95, "85": 3933.87, "90": 4868.11},
      "Melaka": {"70": 1688.03, "75": 2321.65, "80": 3058.49, "85": 3892.52, "90": 4816.88, "95": 5824.49, "100": 6908.34, "100": 7194.29, "100": 7388.41},
      "Negeri Sembilan": {"70": 1704.15, "75": 2343.88, "80": 3087.85, "85": 3929.92, "90": 4863.22},
      "Pahang": {"70": 1721.96, "75": 2368.47, "80": 3120.3, "85": 3971.28, "90": 4914.45},
      "Perak": {"70": 1696.94, "75": 2333.94, "80": 3074.72, "85": 3913.2, "90": 4842.5, "95": 5855.49, "100": 6945.12, "100": 7232.6, "100": 7427.75},
      "Perlis": {"70": 1704.15, "75": 2343.88, "80": 3087.85, "85": 3929.92, "90": 4863.22},
      "Pulau Pinang": {"70": 1720.26, "75": 2366.12, "80": 3117.2, "85": 3967.33, "90": 4909.56},
      "Sabah": {"70": 1738.07, "75": 2390.7, "80": 3149.65, "85": 4008.69, "90": 4960.79, "95": 5998.63, "100": 7114.99},
      "Sarawak": {"70": 1729.17, "75": 2378.41, "80": 3133.42, "85": 3988.01, "90": 4935.17, "95": 5967.63, "100": 7078.2},
      "Selangor": {"70": 1713.05, "75": 2356.17, "80": 3104.07, "85": 3950.6, "90": 4888.83},
      "Terengganu": {"70": 1705.85, "75": 2346.23, "80": 3090.95, "85": 3933.87, "90": 4868.11},
      "W.P Labuan": {"70": 1720.26, "75": 2366.12, "80": 3117.2, "85": 3967.33, "90": 4909.56},
      "W.P. Kuala Lumpur": {"70": 1720.26, "75": 2366.12, "80": 3117.2, "85": 3967.33, "90": 4909.56},
      "W.P. Putrajaya": {"70": 1720.26, "75": 2366.12, "80": 3117.2, "85": 3967.33, "90": 4909.56}
      },
  "Oil Palm": {
      "Johor": {"70": 236.59, "75": 400.31, "80": 629.46, "85": 929, "90": 1300.26},
      "Kedah": {"70": 235.45, "75": 398.3, "80": 626.24, "85": 924.2, "90": 1293.49, "95": 1732.45, "100": 2237.18, "100": 2438.09, "100": 2580.02},
      "Kelantan": {"70": 238.66, "75": 403.94, "80": 635.28, "85": 937.69, "90": 1312.5},
      "Melaka": {"70": 236.37, "75": 399.92, "80": 628.84, "85": 928.08, "90": 1298.97},
      "Negeri Sembilan": {"70": 234.3, "75": 396.29, "80": 623.02, "85": 919.4, "90": 1286.73, "95": 1723.35, "100": 2225.4, "100": 2425.25, "100": 2566.43},
      "Pahang": {"70": 238.66, "75": 403.94, "80": 635.28, "85": 937.69, "90": 1312.5},
      "Perak": {"70": 235.45, "75": 398.3, "80": 626.24, "85": 924.2, "90": 1293.49, "95": 1732.45, "100": 2237.18, "100": 2438.09, "100": 2580.02},
      "Perlis": {"70": 236.37, "75": 399.92, "80": 628.84, "85": 928.08, "90": 1298.97},
      "Pulau Pinang": {"70": 238.44, "75": 403.56, "80": 634.67, "85": 936.77, "90": 1311.2},
      "Sabah": {"70": 240.73, "75": 407.58, "80": 641.11, "85": 946.38, "90": 1324.73, "95": 1774.45, "100": 2291.57},
      "Sarawak": {"70": 239.59, "75": 405.57, "80": 637.89, "85": 941.58, "90": 1317.97, "95": 1765.36, "100": 2279.79},
      "Selangor": {"70": 237.52, "75": 401.93, "80": 632.06, "85": 932.89, "90": 1305.73},
      "Terengganu": {"70": 236.59, "75": 400.31, "80": 629.46, "85": 929, "90": 1300.26},
      "W.P Labuan": {"70": 238.44, "75": 403.56, "80": 634.67, "85": 936.77, "90": 1311.2},
      "W.P. Kuala Lumpur": {"70": 238.44, "75": 403.56, "80": 634.67, "85": 936.77, "90": 1311.2},
      "W.P. Putrajaya": {"70": 238.44, "75": 403.56, "80": 634.67, "85": 936.77, "90": 1311.2}
      },
  "Pineapple": {
      "Johor": {"70": 20.06, "75": 20.86, "80": 27.45, "85": 61.86, "90": 186.77},
      "Kedah": {"70": 20.06, "75": 20.86, "80": 27.41, "85": 61.64, "90": 185.89, "95": 521.72, "100": 1234.97, "100": 2014.05, "100": 2779.98},
      "Kelantan": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.26, "90": 188.37},
      "Melaka": {"70": 20.06, "75": 20.85, "80": 27.37, "85": 61.42, "90": 185.01, "95": 519.05, "100": 1228.51, "100": 2003.46, "100": 2765.32},
      "Negeri Sembilan": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.22, "90": 188.2},
      "Pahang": {"70": 20.06, "75": 20.88, "80": 27.6, "85": 62.66, "90": 189.96, "95": 534.02, "100": 1264.77},
      "Perak": {"70": 20.06, "75": 20.86, "80": 27.41, "85": 61.64, "90": 185.89, "95": 521.72, "100": 1234.97, "100": 2014.05, "100": 2779.98},
      "Perlis": {"70": 20.06, "75": 20.86, "80": 27.45, "85": 61.82, "90": 186.6},
      "Pulau Pinang": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.22, "90": 188.2},
      "Sabah": {"70": 20.06, "75": 20.88, "80": 27.6, "85": 62.66, "90": 189.96, "95": 534.02, "100": 1264.77},
      "Sarawak": {"70": 20.06, "75": 20.87, "80": 27.56, "85": 62.44, "90": 189.08, "95": 531.36, "100": 1258.32},
      "Selangor": {"70": 20.06, "75": 20.86, "80": 27.41, "85": 61.64, "90": 185.89, "95": 521.72, "100": 1234.97, "100": 2014.05, "100": 2779.98},
      "Terengganu": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.26, "90": 188.37},
      "W.P Labuan": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.22, "90": 188.2},
      "W.P. Kuala Lumpur": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.22, "90": 188.2},
      "W.P. Putrajaya": {"70": 20.06, "75": 20.87, "80": 27.52, "85": 62.22, "90": 188.2}
      },
  "Rubber": {
      "Johor": {"70": 93.08, "75": 124.45, "80": 161.86, "85": 205.04, "90": 253.62},
      "Kedah": {"70": 92.69, "75": 123.9, "80": 161.11, "85": 204.06, "90": 252.39, "95": 305.68, "100": 363.52, "100": 380.05, "100": 391.32},
      "Kelantan": {"70": 93.78, "75": 125.45, "80": 163.22, "85": 206.81, "90": 255.86},
      "Melaka": {"70": 93, "75": 124.34, "80": 161.72, "85": 204.85, "90": 253.39},
      "Negeri Sembilan": {"70": 92.3, "75": 123.34, "80": 160.36, "85": 203.09, "90": 251.15, "95": 304.16, "100": 361.69, "100": 378.14, "100": 389.34},
      "Pahang": {"70": 93.78, "75": 125.45, "80": 163.22, "85": 206.81, "90": 255.86},
      "Perak": {"70": 93.39, "75": 124.89, "80": 162.47, "85": 205.83, "90": 254.62},
      "Perlis": {"70": 93, "75": 124.34, "80": 161.72, "85": 204.85, "90": 253.39},
      "Pulau Pinang": {"70": 93.7, "75": 125.34, "80": 163.07, "85": 206.62, "90": 255.62},
      "Sabah": {"70": 94.47, "75": 126.44, "80": 164.57, "85": 208.58, "90": 258.09, "95": 312.69, "100": 371.95},
      "Sarawak": {"70": 94.09, "75": 125.89, "80": 163.82, "85": 207.6, "90": 256.85, "95": 311.17, "100": 370.12},
      "Selangor": {"70": 93.39, "75": 124.89, "80": 162.47, "85": 205.83, "90": 254.62},
      "Terengganu": {"70": 93.08, "75": 124.45, "80": 161.86, "85": 205.04, "90": 253.62},
      "W.P Labuan": {"70": 93.7, "75": 125.34, "80": 163.07, "85": 206.62, "90": 255.62},
      "W.P. Kuala Lumpur": {"70": 93.7, "75": 125.34, "80": 163.07, "85": 206.62, "90": 255.62},
      "W.P. Putrajaya": {"70": 93.7, "75": 125.34, "80": 163.07, "85": 206.62, "90": 255.62}
      }
};
  
/* === Êõ¥Êñ∞ Trigger Level ‰∏ãÊãâÈÄâÈ°π === */
function updateCoverageOptions(){
  const s = document.getElementById("state").value;
  const c = document.getElementById("crop").value;
  const triggerSelect = document.getElementById("trigger");

  triggerSelect.innerHTML = "";

  if(s && c && coverageLimits[c] && coverageLimits[c][s]){
    const [min,max] = coverageLimits[c][s];
    for(let i=min;i<=max;i+=5){
      const o = document.createElement("option");
      o.value = i / 100;
      o.textContent = i + "%";
      triggerSelect.appendChild(o);
    }

    // üü¢ Ëá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÈÄâÈ°πÂπ∂Ëß¶Âèë coverage ËÆ°ÁÆó
    triggerSelect.selectedIndex = 0;
    updateCoverageLevel();

  } else {
    const o=document.createElement("option");
    o.textContent="Select crop and state first";
    triggerSelect.appendChild(o);
  }

  // Ê∏ÖÁ©∫ Coverage Level input
  document.getElementById("coverage").value="";
}

/* === ÂΩì Trigger Level ÊîπÂèòÊó∂Ëá™Âä®ËÆ°ÁÆó Coverage Level (Trigger +20%) === */
function updateCoverageLevel(){
  const triggerVal = parseFloat(document.getElementById("trigger").value);
  if(!isNaN(triggerVal)){
    const coverage = Math.min(triggerVal + 0.20, 1.0); // ‰∏çË∂ÖËøá100%
    document.getElementById("coverage").value = (coverage*100).toFixed(0) + "%";
    document.getElementById("coverage").dataset.value = coverage;
  } else {
    document.getElementById("coverage").value = "";
    document.getElementById("coverage").dataset.value = "";
  }
}
/* === Promo Code ÂàóË°® === */
const promoCodes = {
  "WELCOME": 0.3,
};

let activePromo = { code: null, rate: 0 };

function togglePromoEdit(isEdit) {
  const display = document.getElementById("promoDisplay");
  const edit = document.getElementById("promoEdit");

  if (isEdit) {
    display.style.display = "none";
    edit.style.display = "block";
  } else {
    display.style.display = "flex";
    edit.style.display = "none";
  }
}


function applyPromo() {
  const code = document.getElementById("promoInput").value.trim().toUpperCase();
  const message = document.getElementById("promoMessage");
  const displayText = document.getElementById("promoStatusText");

  if (!code) {
    message.textContent = "Please enter a promo code.";
    message.style.color = "red";
    return;
  }

  if (promoCodes[code]) {
    activePromo = { code, rate: promoCodes[code] };
    message.textContent = `Promo code ${code} applied (${(promoCodes[code] * 100).toFixed(0)}% off)`;
    message.style.color = "green";
    displayText.textContent = `${(promoCodes[code] * 100).toFixed(0)}% off first-year premium. Promo code ${code} applied.`;

    togglePromoEdit(false);

    // ‚úÖ ÊàêÂäüÂêéËá™Âä®Ëß¶ÂèëËÆ°ÁÆóÔºö
    const crop = document.getElementById("crop").value;
    const state = document.getElementById("state").value;
    const area = parseFloat(document.getElementById("area").value);
    const trigger = parseFloat(document.getElementById("trigger").value);
    const coverage = parseFloat(document.getElementById("coverage").dataset.value);

    // ÂÖàÁ°ÆËÆ§Áî®Êà∑ËµÑÊñôÂÆåÊï¥ÔºåÈò≤Ê≠¢Á©∫ÁÆó
    if (crop && state && !isNaN(trigger) && !isNaN(coverage) && !isNaN(area)) {
      calculatePremium();  // ‚úÖ Ëá™Âä®ËÆ°ÁÆó
    }

  } else {
    message.textContent = "Invalid promo code.";
    message.style.color = "red";
    activePromo = { code: null, rate: 0 };
  }
}
/* === Ê†∏ÁÆó‰øùË¥π === */
function calculatePremium(){
  const crop = document.getElementById("crop").value;
  const state = document.getElementById("state").value;
  const area = parseFloat(document.getElementById("area").value);
  const trigger = parseFloat(document.getElementById("trigger").value);
  const coverage = parseFloat(document.getElementById("coverage").dataset.value);
  
  if(!crop || !state || isNaN(trigger) || isNaN(coverage)){
    alert("Please fill all required fields.");
    return;
  }

  // ‚úÖ Êñ∞Ê†ºÂºèÔºöÊåâ trigger level Êü•Êâæ
  const triggerPct = Math.round(trigger * 100).toString();
  const grossData = grossPremiumTable[crop]?.[state];
  
  if(!grossData){
    alert("No data for this crop/state.");
    return;
  }
  
  const gross = grossData[triggerPct];
  
  if(gross === undefined){
    alert(`No premium data for ${crop} in ${state} at ${triggerPct}% trigger level.`);
    return;
  }

  const totalPremium = gross * area;
  const discountRate = activePromo.rate;
  const discountedTotal = totalPremium * (1 - discountRate);

  // Êõ¥Êñ∞ÊèêÁ§∫Êù°
  const promoNotice = document.getElementById("promoNotice");
  const promoNoticeText = document.getElementById("promoNoticeText");
  
  if (discountRate > 0) {
    promoNoticeText.innerHTML =
      `‚úî Promo code <strong>${activePromo.code}</strong> applied ‚Äî ${(discountRate * 100).toFixed(0)}% off total premium.`;
    promoNotice.style.display = "block";
  } else {
    promoNotice.style.display = "none";
  }

  const r = document.getElementById("resultBox");
  r.style.display = "block";
  r.innerHTML = `
    <strong>TOTAL PREMIUM CALCULATOR</strong><br>
    <strong>${crop}</strong> (${state})<br>
    Trigger Level: ${triggerPct}%<br>
    Coverage Level: ${(coverage*100).toFixed(0)}%<br>
    Gross Premium (per ha): <strong>RM ${gross.toLocaleString(undefined,{maximumFractionDigits:2})}</strong><br>
    <div class="highlight-total">
      Total‚ÄØPremium‚ÄØfor‚ÄØ${area}‚ÄØha:&nbsp;
      ${
        discountRate > 0
          ? `<span class="old-price">RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</span>
             <span class="arrow">‚Üí</span>
             <span class="new-price">RM¬†${discountedTotal.toLocaleString(undefined,{maximumFractionDigits:2})}</span>`
          : `<strong>RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</strong>`
      }
    </div>
    ${discountRate>0?`<div class="discount-note">Promo <strong>${activePromo.code}</strong> applied (${(discountRate*100).toFixed(0)}% off)</div>`:""}
  `;
}
</script>
</body>
</html>
