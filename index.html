<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TerraShield Agriculture Insurance</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<style>
:root {
  --gold: #E3A008;
  --dark-gold: #D97706;
  --light-cream: #FFF8E5;
  --text-dark: #2C2A29;
  --bg: #FFFCF7;
}

/* ====== Global Base ====== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Poppins', sans-serif;
}

html { scroll-behavior: smooth; }
body { background: var(--bg); color: var(--text-dark); }

header {
  background: linear-gradient(90deg, var(--gold), var(--dark-gold));
  color: white;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 10;
}

.logo-box { display: flex; align-items: center; gap: 10px; }
.logo { height: 48px; width: auto; }
header h1 { font-size: 1.3rem; letter-spacing: .5px; }

nav a {
  color: white;
  text-decoration: none;
  margin-left: 1.2rem;
  font-weight: 500;
  position: relative;
  padding-bottom: 4px;
  transition: color 0.3s ease;
}
nav a:hover { color: var(--light-cream); }
nav a.active {
  color: var(--light-cream);
  font-weight: 600;
}
nav a.active::after {
  content: "";
  position: absolute;
  left: 0; bottom: 0;
  width: 100%; height: 2px;
  background: var(--light-cream);
}

/* ===== Hero Section ===== */
.hero {
  background: linear-gradient(to right, #FFF7E0, #FFF8E5);
  text-align: center;
  padding: 4rem 1rem 3rem;
}
.hero h2 { font-size: 2.2rem; color: var(--dark-gold); }
.slogan {
  font-style: italic;
  color: var(--dark-gold);
  font-size: 1.5rem;
  font-weight: 500;
  margin-top: .3rem;
  margin-bottom: 1rem;
  opacity: 0;
  transform: translateY(10px);
  animation: fadeInSlogan 1.8s ease forwards;
  animation-delay: .5s;
}
@keyframes fadeInSlogan { to { opacity: 1; transform: translateY(0); } }
.sub-brand {
  font-size: .95rem;
  color: #8b6b2e;
  font-style: italic;
  margin-top: .5rem;
  margin-bottom: 1.2rem;
  opacity: 0;
  transform: translateY(8px);
  animation: fadeInSub 1.6s ease forwards;
  animation-delay: .6s;
  border-top: 1px solid #f3e1b2;
  display: inline-block;
  padding-top: .4rem;
}
@keyframes fadeInSub {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}


/* ===== Containers ===== */
.container {
  max-width: 900px;
  background: white;
  margin: 3rem auto;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.08);
}
h3 { text-align: center; color: var(--dark-gold); margin-bottom: 1.2rem; }

/* ===== Premium Calculator Grid ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 1rem;
}
label { display: block; font-size: .9rem; margin-bottom: .3rem; }
select, input {
  width: 100%;
  padding: .8rem;
  border-radius: 6px;
  border: 1px solid #ddd;
}
button {
  display: block;
  background: var(--dark-gold);
  color: white;
  border: none;
  margin: 1.5rem auto 0;
  padding: .9rem 2.2rem;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.05rem;
}
button:hover {
  background: var(--gold);
  transform: translateY(-2px);
  transition: .2s;
}

/* ===== Result Box ===== */
#resultBox {
  display: none;
  background: var(--light-cream);
  text-align: center;
  margin-top: 1rem;
  padding: 1rem;
  border-radius: 8px;
  color: var(--dark-gold);
  font-weight: 500;
}

/* ===== Promo Card ===== */
.promo-card {
  max-width: 900px;
  margin: 2.5rem auto;
  background: #ffffff;
  border: 1px solid #f1e1bd;
  border-radius: 12px;
  padding: 1.4rem 1.8rem;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
}
.promo-card:hover {
  box-shadow: 0 5px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-2px);
}
.promo-display {
  display: flex;
  justify-content: space-between;   /* Â∑¶ÊñáÂ≠óÂè≥ÊåâÈíÆ */
  align-items: baseline;            /* ‚úÖ ÂØπÈΩêÂà∞ÊñáÂ≠óÁöÑÂ∫ïÁ∫ø */
  padding: 0.9rem 1.2rem;
}

.promo-text {
  color: #4b3b08;
  font-weight: 600;
  font-size: 1.05rem;
  line-height: 1.4;                 /* ‚úÖ Á°Æ‰øùÊñáÂ≠óÊúâÊ†áÂáÜË°åÈ´ò */
}

.promo-edit-btn {
  background: #fff8e5;
  border: 2px solid #d97706;
  color: #d97706;
  font-weight: 700;
  font-size: 0.95rem;
  padding: 0.55rem 1.4rem;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  position: relative;
  top: -1px;                        /* ‚úÖ ÂæÆË∞ÉÔºå‰ΩøÊåâÈíÆ‰∏éÊñáÂ≠ó‰∏≠ÂøÉÂÆåÁæéÂØπÈΩê */
  transition: all 0.25s ease;
}
.promo-edit-btn:hover {
  background: var(--dark-gold);
  color: #fff;
}
.promo-banner {
  display: none;
  background: #ebf7ee;               /* ÊüîÂíåÁªøÂ∫ï */
  border-left: 5px solid #16a34a;    /* Ê∑±ÁªøÁ∫ø */
  border-radius: 6px;
  padding: 0.75rem 1rem;
  margin-top: 1.2rem;
  color: #166534;
  font-weight: 500;
  animation: fadeInPromo 0.5s ease;
}
/* ===== Coverage / Overview Section ===== */
#overview,
#coverage-preview {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;               /* ‚úÖ ÊñáÊú¨Â∑¶ÂØπÈΩê */
}
#coverage-preview { background: #fff9ee; } /* ‰øùÊåÅÊ∑°ÈªÑËâ≤ËÉåÊôØ */
/* ‚úÖ ËÆ©ÊåâÈíÆÂ±Ö‰∏≠ */
#coverage-preview {
  text-align: center; /* Áà∂ÂÆπÂô®Â±Ö‰∏≠ÔºåÊåâÈíÆËá™Âä®Â±Ö‰∏≠ */
}

#coverage-preview p {
  text-align: left; /* ÊÆµËêΩ‰ªçÁÑ∂Â∑¶ÂØπÈΩê */
}
#overview h3,
#coverage-preview h3 {
  text-align: center;
  margin-bottom: 1rem;
}
#overview p,
#coverage-preview p {
  font-size: 1rem;
  line-height: 1.75;
  margin: 0 0 1.5rem 0;
  letter-spacing: 0.3px;
  word-spacing: 1px;
}
#coverage-preview .coverage-btn {
  display: inline-block;
  margin: 0 auto;
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 0.7rem 1.6rem;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 500;
  transition: background 0.3s ease;
}
#coverage-preview .coverage-btn:hover { background: var(--gold); }

/* ===== Contact Section ===== */
#contact {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;
}
/* Force the disclaimer container to left-align */
.disclaimer-bar {
  text-align: left !important;   /* ‚úÖ Áà∂Á∫ßÂº∫Âà∂Â∑¶ÂØπÈΩê */
}
  
/* ===== Disclaimer  ===== */
.disclaimer-bar p {
  font-family: 'Poppins', sans-serif;
  font-style: italic;
  font-size: 0.9rem;
  line-height: 1.6;
  color: var(--dark-gold);
  text-align: left;
  margin-top: 1.5rem;
  margin-bottom: 0;
}

/* ===== Footer ===== */
footer {
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 1.2rem;
  margin-top: 4rem;
  font-size: 0.9rem;
}

/* ===== Responsive ===== */
@media(max-width:600px) {
  header { flex-direction: column; align-items: flex-start; }
  .container { padding: 1.5rem; }
  #overview, #coverage-preview, #contact, .promo-card { padding: 1.5rem; }
  .hero h2 { font-size: 1.7rem; }
  .disclaimer-bar p { font-size: 0.8rem; }
}
/* ===== Promo Edit / Input layout ===== */
.promo-edit {
  padding: 0.9rem 1.2rem;
  border-top: 1px solid #f0e3c4;
  border-radius: 8px;
  background: #fffdf8;
  margin-top: 0.8rem;
}

.promo-edit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  color: var(--dark-gold);
  font-weight: 600;
}

.promo-input-row {
  display: flex;
  gap: 0.8rem;
}

.promo-input-row input {
  flex: 1;
  padding: 0.75rem;
  font-size: 0.95rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  color: #333;
}

.promo-input-row input:focus {
  outline: none;
  border-color: var(--dark-gold);
  box-shadow: 0 0 3px rgba(217, 119, 6, 0.3);
}

.promo-apply,
.promo-cancel {
  background: var(--dark-gold);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.65rem 1.2rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s ease;
}

.promo-apply:hover,
.promo-cancel:hover {
  background: var(--gold);
}

.promo-message {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  font-weight: 500;
}

.arrow {
  font-weight: 500;
  color: #7a621f;
  margin: 0 4px;
}
/* ===== Promo Discount Styling ===== */
.old-price {
  text-decoration: line-through;
  color:  #9ca3af;            /* ÁÅ∞Ëâ≤ */
  margin-right: 0.5rem;
  opacity: 0.8;
}

.new-price {
  color: #166534;            /* ÁªøËâ≤‰ª£Ë°®ËäÇÁúÅ */
  font-weight: 700;
}
/* ===== Highlight Total Premium Line ===== */
.highlight-total {
  background-color: #fff8e1;
  border-radius: 8px;
  padding: 0.7rem 1.2rem;
  margin-top: 0.8rem;
  display: inline-block;
  font-weight: 700;
  color: #b45309;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  font-size: 1rem;
  text-align: center;
  transition: background-color 0.3s ease, transform 0.3s ease;
}
#resultBox .highlight-total {
  display: block;
  width: fit-content;
  margin: 0.8rem auto;
}
.highlight-total:hover {
  background-color: #ffefc6;
  transform: scale(1.03);
}

/* ===== Promo ËØ¥ÊòéË°åÔºàÊ∑°ÂÖ•Âä®ÊïàÔºâ ===== */
#resultBox .discount-note {
  margin-top: 0.6rem;
  font-size: 0.9rem;
  color: #166534 !important;   /* Ê∑±ÁªøËâ≤ */
  font-weight: 500;
  opacity: 0;                   /* Ëµ∑ÂßãÈÄèÊòé */
  transform: translateY(6px);   /* Ëµ∑ÂßãÂæÆ‰∏ãÁßª */
  animation: fadeInUp 0.6s ease forwards;
}

/* Hover ËΩªËâ≤ÂèòÂåñ */
#resultBox .discount-note:hover {
  color: #0f5132 !important;
}

/* Âä®ÁîªÂÖ≥ÈîÆÂ∏ß */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
  
</head>

<body>
<div id="site-header"></div>

<section class="hero">
  <h2>Protecting‚ÄØFarmers,‚ÄØSecuring‚ÄØHarvests</h2>
  <h3 class="slogan">‚ÄúLebih‚ÄØPasti,‚ÄØLebih‚ÄØTenang‚Äù</h3>
  <p class="sub-brand">Powered‚ÄØby‚ÄØ<strong>AgroShield‚ÄØIncome‚ÄØGuard</strong> ‚Äî An‚ÄØIncome‚ÄØProtection‚ÄØPlan‚ÄØby‚ÄØTerraShield‚ÄØInsurance</p>
  <p>Estimate‚ÄØ your‚ÄØ agricultural‚ÄØ insurance‚ÄØ premium‚ÄØ instantly‚ÄØ for‚ÄØ your‚ÄØ crops‚ÄØ in‚ÄØ Malaysia.</p>
</section>

  
<section id="calculator" class="container">
  <h3>Premium Calculator</h3>
  <div class="grid">
    <div>
      <label for="state">State</label>
      <select id="state" onchange="updateCoverageOptions()">
        <option value="">-- Select State --</option>
        <option>Johor</option><option>Kedah</option><option>Kelantan</option><option>Melaka</option>
        <option>Negeri Sembilan</option><option>Pahang</option><option>Perak</option><option>Perlis</option>
        <option>Pulau Pinang</option><option>Sabah</option><option>Sarawak</option><option>Selangor</option>
        <option>Terengganu</option><option>W.P. Kuala Lumpur</option><option>W.P Labuan</option><option>W.P. Putrajaya</option>
      </select>
    </div>
    <div>
      <label for="district">District</label>
      <input id="district" placeholder="e.g. Kota Setar" />
    </div>
    <div>
      <label for="crop">Crop</label>
      <select id="crop" onchange="updateCoverageOptions()">
        <option value="">-- Select Crop --</option>
        <option>Oil Palm</option><option>Rubber</option>
        <option>Cocoa</option><option>Durian</option><option>Coconut</option>
        <option>Pineapple</option><option>Mango</option>
      </select>
    </div>
    <!-- ‚úÖ ÁßªÈô§‰∫Ü Expected Yield -->
    <div>
      <label for="area">Area (ha)</label>
      <input id="area" type="number" value="10" step="0.1" />
    </div>
    <div>
      <label for="trigger">Trigger Level</label>
      <select id="trigger" onchange="updateCoverageLevel()">
        <option value="">Select crop/state first</option>
      </select>
    </div>
    <div>
      <label for="coverage">Coverage Level</label>
      <input id="coverage" type="text" readonly placeholder="Auto‚Äëcalculated" />   
    </div>
    <p style="font-size:0.9rem;color:#8b6b2e;margin-top:0.5rem;
               display:flex;align-items:center;gap:8px;
               letter-spacing:0.5px;word-spacing:1px;line-height:1.7;">
      <span style="font-size:1.1rem;">üí°</span>
      <span>
        Coverage‚ÄØis‚ÄØalways‚ÄØ<strong>20%‚ÄØhigher</strong>‚ÄØthan‚ÄØthe‚ÄØtrigger‚ÄØlevelÔºå
        this‚ÄØmeans‚ÄØonce‚ÄØyour‚ÄØloss‚ÄØreaches‚ÄØthe‚ÄØtrigger‚ÄØpoint,‚ÄØTerraShield‚ÄØwill‚ÄØcover‚ÄØup‚ÄØto‚ÄØ20%‚ÄØmore‚ÄØto‚ÄØprotect‚ÄØyou‚ÄØbetter.
      </span>
    </p>
  </div>
  <button onclick="calculatePremium()">Calculate</button>
  <div id="promoNotice" class="promo-banner">
    <span id="promoNoticeText"></span>
  </div>
  <div id="resultBox"></div>
  <div class="disclaimer-bar">
  <p>
  The above premiums are calculated at the standard premium rate and are for reference only.
  The actual premiums paid must include the premium levy collected by the Insurance Authority.
  </p>
  </div>

</section>
<!-- Promo Section -->
<div id="promoContainer" class="promo-card">
  <!-- Â±ïÁ§∫Ê®°Âºè -->
  <div id="promoDisplay" class="promo-display">
    <div class="promo-text">
      <span id="promoStatusText">No promotion code applied.</span>
    </div>
    <button class="promo-edit-btn" onclick="togglePromoEdit(true)">Edit Promo Code</button>
  </div>

  <!-- ÁºñËæëÊ®°Âºè -->
  <div id="promoEdit" class="promo-edit" style="display:none;">
    <div class="promo-edit-header">
      <span>Enter your Promotion Code</span>
    </div>
    <div class="promo-input-row">
      <input id="promoInput" placeholder="e.g.‚ÄØWELCOME" />
      <button class="promo-apply" onclick="applyPromo()">Apply</button>
    </div>
    <div id="promoMessage" class="promo-message"></div>
  </div>
</div>
  
<!-- ‚¨áÔ∏è ÊîæÂú® Footer ‰∏äÊñπ -->
<section id="overview" class="container">
  <h3>About‚ÄØTerraShield</h3>
  <p>
    TerraShield empowers Malaysian farmers‚ÄØwith reliable,‚ÄØdata‚Äëdriven‚ÄØinsurance tools to make crop protection‚ÄØ
    transparent and‚ÄØaffordable for‚ÄØsustainable‚ÄØgrowth.
  </p>
</section>

<section id="coverage-preview" class="container coverage-preview">
  <h3>Crop‚ÄØ&‚ÄØRisk‚ÄØCoverage‚ÄØOverview</h3>
  <p>
    Learn which crops and‚ÄØrisks are included in our‚ÄØMalaysian‚ÄØAgricultural‚ÄØInsurance Program¬†‚Äî from rice, 
    durian,‚ÄØand oil palm to‚ÄØprotection‚ÄØfrom floods,‚ÄØdroughts, and‚ÄØtyphoons.
  </p>
  <a class="coverage-btn" href="./coverage.html">View‚ÄØFull‚ÄØCoverage¬†‚Üí</a>
</section>

<section id="contact" class="container">
  <h3>Contact‚ÄØUs</h3>
  <p>
    Email:‚ÄØ<a href="mailto:info@terrashield.my">info@terrashield.my</a><br/>
    Kuala‚ÄØLumpur,‚ÄØMalaysia
  </p>
</section>

<footer>¬©‚ÄØ2025‚ÄØTerraShield‚ÄØAgriculture‚ÄØInsurance‚ÄØ|‚ÄØAll‚ÄØRights‚ÄØReserved</footer>

<script>
fetch('./header.html?v=20251125')
  .then(r=>r.text())
  .then(h=>{document.getElementById('site-header').innerHTML=h;
    const p=location.pathname.split("/").pop()||"index.html";
    document.querySelectorAll("nav a").forEach(a=>{if(a.href.includes(p))a.classList.add("active");});
  }).catch(console.error);

/* ===== Coverage limits (for dropdown) ===== */
const coverageLimits = {
  "Oil Palm": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Durian": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,80], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Rubber": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Selangor":[50,70], "Terengganu":[50,70],
    "Sabah":[50,80], "Sarawak":[50,80], "W.P. Kuala Lumpur":[50,70],
    "W.P Labuan":[50,70], "W.P. Putrajaya":[50,70]
  },

  "Pineapple": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,90],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Cocoa": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Coconut": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Mango": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  }
};

/* === ÂÖ®ÈÉ®‰ΩúÁâ©ÁöÑ Gross Premium Ë°®Ê†º === */
const grossPremiumTable = {
  "Cocoa": {
    "Johor": {"70": 56.16, "75": 71.81, "80": 90.54, "85": 112.23, "90": 136.7},
    "Kedah": {"70": 55.54, "75": 70.92, "80": 89.33, "85": 110.64, "90": 134.69},
    "Kelantan": {"70": 56.16, "75": 71.81, "80": 90.54, "85": 112.23, "90": 136.7},
    "Melaka": {"70": 56.05, "75": 71.64, "80": 90.31, "85": 111.92, "90": 136.32},
    "Negeri Sembilan": {"70": 56.05, "75": 71.64, "80": 90.31, "85": 111.92, "90": 136.32},
    "Pahang": {"70": 57.29, "75": 73.43, "80": 92.74, "85": 115.09, "90": 140.33},
    "Perak": {"70": 55.54, "75": 70.92, "80": 89.33, "85": 110.64, "90": 134.69},
    "Perlis": {"70": 56.05, "75": 71.64, "80": 90.31, "85": 111.92, "90": 136.32},
    "Pulau Pinang": {"70": 57.17, "75": 73.26, "80": 92.5, "85": 114.79, "90": 139.94},
    "Sabah": {"70": 58.41, "75": 75.04, "80": 94.93, "85": 117.96, "90": 143.96},
    "Sarawak": {"70": 57.79, "75": 74.15, "80": 93.72, "85": 116.38, "90": 141.95},
    "Selangor": {"70": 56.67, "75": 72.53, "80": 91.52, "85": 113.51, "90": 138.32},
    "Terengganu": {"70": 56.16, "75": 71.81, "80": 90.54, "85": 112.23, "90": 136.7},
    "W.P Labuan": {"70": 57.17, "75": 73.26, "80": 92.5, "85": 114.79, "90": 139.94},
    "W.P. Kuala Lumpur": {"70": 57.17, "75": 73.26, "80": 92.5, "85": 114.79, "90": 139.94},
    "W.P. Putrajaya": {"70": 57.17, "75": 73.26, "80": 92.5, "85": 114.79, "90": 139.94}
  },
  "Coconut": {
    "Johor": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.84},
    "Kedah": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.74},
    "Kelantan": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.84},
    "Melaka": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.82},
    "Negeri Sembilan": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.82},
    "Pahang": {"70": 20, "75": 20, "80": 20.06, "85": 20.76, "90": 26.02},
    "Perak": {"70": 20, "75": 20, "80": 20.05, "85": 20.73, "90": 25.74},
    "Perlis": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.82},
    "Pulau Pinang": {"70": 20, "75": 20, "80": 20.06, "85": 20.76, "90": 26},
    "Sabah": {"70": 20, "75": 20, "80": 20.06, "85": 20.79, "90": 26.2},
    "Sarawak": {"70": 20, "75": 20, "80": 20.06, "85": 20.77, "90": 26.1},
    "Selangor": {"70": 20, "75": 20, "80": 20.06, "85": 20.75, "90": 25.92},
    "Terengganu": {"70": 20, "75": 20, "80": 20.05, "85": 20.74, "90": 25.84},
    "W.P Labuan": {"70": 20, "75": 20, "80": 20.06, "85": 20.76, "90": 26},
    "W.P. Kuala Lumpur": {"70": 20, "75": 20, "80": 20.06, "85": 20.76, "90": 26},
    "W.P. Putrajaya": {"70": 20, "75": 20, "80": 20.06, "85": 20.76, "90": 26}
  },
  "Durian": {
    "Johor": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.61},
    "Kedah": {"70": 20, "75": 20, "80": 20.03, "85": 20.91, "90": 34.36},
    "Kelantan": {"70": 20, "75": 20, "80": 20.03, "85": 20.96, "90": 35.07},
    "Melaka": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.56},
    "Negeri Sembilan": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.56},
    "Pahang": {"70": 20, "75": 20, "80": 20.03, "85": 20.96, "90": 35.07},
    "Perak": {"70": 20, "75": 20, "80": 20.03, "85": 20.97, "90": 35.27},
    "Perlis": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.56},
    "Pulau Pinang": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.56},
    "Sabah": {"70": 20, "75": 20, "80": 20.03, "85": 20.99, "90": 35.52},
    "Sarawak": {"70": 20, "75": 20, "80": 20.03, "85": 20.97, "90": 35.27},
    "Selangor": {"70": 20, "75": 20, "80": 20.03, "85": 20.94, "90": 34.81},
    "Terengganu": {"70": 20, "75": 20, "80": 20.03, "85": 20.93, "90": 34.61},
    "W.P Labuan": {"70": 20, "75": 20, "80": 20.03, "85": 20.96, "90": 35.02},
    "W.P. Kuala Lumpur": {"70": 20, "75": 20, "80": 20.03, "85": 20.96, "90": 35.02},
    "W.P. Putrajaya": {"70": 20, "75": 20, "80": 20.03, "85": 20.96, "90": 35.02}
  },
  "Mango": {
    "Johor": {"70": 1747.42, "75": 2403.59, "80": 3166.66, "85": 4030.38, "90": 4987.65},
    "Kedah": {"70": 1717.72, "75": 2362.62, "80": 3112.58, "85": 3961.45, "90": 4902.27},
    "Kelantan": {"70": 1747.42, "75": 2403.59, "80": 3166.66, "85": 4030.38, "90": 4987.65},
    "Melaka": {"70": 1688.03, "75": 2321.65, "80": 3058.49, "85": 3892.52, "90": 4816.88},
    "Negeri Sembilan": {"70": 1741.74, "75": 2395.76, "80": 3156.33, "85": 4017.21, "90": 4971.34},
    "Pahang": {"70": 1801.13, "75": 2477.7, "80": 3264.5, "85": 4155.07, "90": 5142.11},
    "Perak": {"70": 1717.72, "75": 2362.62, "80": 3112.58, "85": 3961.45, "90": 4902.27},
    "Perlis": {"70": 1741.74, "75": 2395.76, "80": 3156.33, "85": 4017.21, "90": 4971.34},
    "Pulau Pinang": {"70": 1795.45, "75": 2469.88, "80": 3254.17, "85": 4141.91, "90": 5125.8},
    "Sabah": {"70": 1854.84, "75": 2551.81, "80": 3362.34, "85": 4279.77, "90": 5296.57},
    "Sarawak": {"70": 1825.15, "75": 2510.85, "80": 3308.26, "85": 4210.84, "90": 5211.19},
    "Selangor": {"70": 1771.44, "75": 2436.73, "80": 3210.42, "85": 4086.14, "90": 5056.73},
    "Terengganu": {"70": 1747.42, "75": 2403.59, "80": 3166.66, "85": 4030.38, "90": 4987.65},
    "W.P Labuan": {"70": 1795.45, "75": 2469.88, "80": 3254.17, "85": 4141.91, "90": 5125.8},
    "W.P. Kuala Lumpur": {"70": 1795.45, "75": 2469.88, "80": 3254.17, "85": 4141.91, "90": 5125.8},
    "W.P. Putrajaya": {"70": 1795.45, "75": 2469.88, "80": 3254.17, "85": 4141.91, "90": 5125.8}
  },
  "Oil Palm": {
    "Johor": {"70": 241.93, "75": 409.68, "80": 644.49, "85": 951.41, "90": 1331.83},
    "Kedah": {"70": 238.12, "75": 402.99, "80": 633.75, "85": 935.41, "90": 1309.28},
    "Kelantan": {"70": 248.83, "75": 421.8, "80": 663.9, "85": 980.37, "90": 1372.61},
    "Melaka": {"70": 241.2, "75": 408.4, "80": 642.44, "85": 948.36, "90": 1327.52},
    "Negeri Sembilan": {"70": 234.3, "75": 396.29, "80": 623.02, "85": 919.4, "90": 1286.73},
    "Pahang": {"70": 248.83, "75": 421.8, "80": 663.9, "85": 980.37, "90": 1372.61},
    "Perak": {"70": 238.12, "75": 402.99, "80": 633.75, "85": 935.41, "90": 1309.28},
    "Perlis": {"70": 241.2, "75": 408.4, "80": 642.44, "85": 948.36, "90": 1327.52},
    "Pulau Pinang": {"70": 248.1, "75": 420.52, "80": 661.85, "85": 977.32, "90": 1368.31},
    "Sabah": {"70": 255.73, "75": 433.92, "80": 683.32, "85": 1009.34, "90": 1413.4},
    "Sarawak": {"70": 251.92, "75": 427.22, "80": 672.59, "85": 993.33, "90": 1390.86},
    "Selangor": {"70": 245.02, "75": 415.1, "80": 653.17, "85": 964.37, "90": 1350.07},
    "Terengganu": {"70": 241.93, "75": 409.68, "80": 644.49, "85": 951.41, "90": 1331.83},
    "W.P Labuan": {"70": 248.1, "75": 420.52, "80": 661.85, "85": 977.32, "90": 1368.31},
    "W.P. Kuala Lumpur": {"70": 248.1, "75": 420.52, "80": 661.85, "85": 977.32, "90": 1368.31},
    "W.P. Putrajaya": {"70": 248.1, "75": 420.52, "80": 661.85, "85": 977.32, "90": 1368.31}
  },
  "Pineapple": {
    "Johor": {"70": 20.06, "75": 20.88, "80": 27.64, "85": 62.89, "90": 190.88},
    "Kedah": {"70": 20.06, "75": 20.87, "80": 27.51, "85": 62.15, "90": 187.95},
    "Kelantan": {"70": 20.06, "75": 20.91, "80": 27.87, "85": 64.22, "90": 196.2},
    "Melaka": {"70": 20.06, "75": 20.85, "80": 27.37, "85": 61.42, "90": 185.01},
    "Negeri Sembilan": {"70": 20.06, "75": 20.91, "80": 27.85, "85": 64.08, "90": 195.64},
    "Pahang": {"70": 20.06, "75": 20.94, "80": 28.11, "85": 65.56, "90": 201.51},
    "Perak": {"70": 20.06, "75": 20.87, "80": 27.51, "85": 62.15, "90": 187.95},
    "Perlis": {"70": 20.06, "75": 20.88, "80": 27.61, "85": 62.75, "90": 190.32},
    "Pulau Pinang": {"70": 20.06, "75": 20.91, "80": 27.85, "85": 64.08, "90": 195.64},
    "Sabah": {"70": 20.06, "75": 20.94, "80": 28.11, "85": 65.56, "90": 201.51},
    "Sarawak": {"70": 20.06, "75": 20.92, "80": 27.98, "85": 64.82, "90": 198.57},
    "Selangor": {"70": 20.06, "75": 20.87, "80": 27.51, "85": 62.15, "90": 187.95},
    "Terengganu": {"70": 20.06, "75": 20.91, "80": 27.87, "85": 64.22, "90": 196.2},
    "W.P Labuan": {"70": 20.06, "75": 20.91, "80": 27.85, "85": 64.08, "90": 195.64},
    "W.P. Kuala Lumpur": {"70": 20.06, "75": 20.91, "80": 27.85, "85": 64.08, "90": 195.64},
    "W.P. Putrajaya": {"70": 20.06, "75": 20.91, "80": 27.85, "85": 64.08, "90": 195.64}
  },
  "Rubber": {
    "Johor": {"70": 94.88, "75": 127.02, "80": 165.36, "85": 209.6, "90": 259.38},
    "Kedah": {"70": 93.59, "75": 125.18, "80": 162.86, "85": 206.35, "90": 255.27},
    "Kelantan": {"70": 97.21, "75": 130.35, "80": 169.88, "85": 215.5, "90": 266.83},
    "Melaka": {"70": 94.63, "75": 126.67, "80": 164.88, "85": 208.98, "90": 258.6},
    "Negeri Sembilan": {"70": 92.3, "75": 123.34, "80": 160.36, "85": 203.09, "90": 251.15},
    "Pahang": {"70": 97.21, "75": 130.35, "80": 169.88, "85": 215.5, "90": 266.83},
    "Perak": {"70": 95.92, "75": 128.51, "80": 167.38, "85": 212.24, "90": 262.71},
    "Perlis": {"70": 94.63, "75": 126.67, "80": 164.88, "85": 208.98, "90": 258.6},
    "Pulau Pinang": {"70": 96.96, "75": 130, "80": 169.4, "85": 214.88, "90": 266.04},
    "Sabah": {"70": 99.53, "75": 133.68, "80": 174.4, "85": 221.39, "90": 274.27},
    "Sarawak": {"70": 98.25, "75": 131.84, "80": 171.9, "85": 218.14, "90": 270.15},
    "Selangor": {"70": 95.92, "75": 128.51, "80": 167.38, "85": 212.24, "90": 262.71},
    "Terengganu": {"70": 94.88, "75": 127.02, "80": 165.36, "85": 209.6, "90": 259.38},
    "W.P Labuan": {"70": 96.96, "75": 130, "80": 169.4, "85": 214.88, "90": 266.04},
    "W.P. Kuala Lumpur": {"70": 96.96, "75": 130, "80": 169.4, "85": 214.88, "90": 266.04},
    "W.P. Putrajaya": {"70": 96.96, "75": 130, "80": 169.4, "85": 214.88, "90": 266.04}
  }
};
  
/* === Êõ¥Êñ∞ Trigger Level ‰∏ãÊãâÈÄâÈ°π === */
function updateCoverageOptions(){
  const s = document.getElementById("state").value;
  const c = document.getElementById("crop").value;
  const triggerSelect = document.getElementById("trigger");

  triggerSelect.innerHTML = "";

  if(s && c && coverageLimits[c] && coverageLimits[c][s]){
    const [min,max] = coverageLimits[c][s];
    for(let i=min;i<=max;i+=5){
      const o = document.createElement("option");
      o.value = i / 100;
      o.textContent = i + "%";
      triggerSelect.appendChild(o);
    }

    // üü¢ Ëá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÈÄâÈ°πÂπ∂Ëß¶Âèë coverage ËÆ°ÁÆó
    triggerSelect.selectedIndex = 0;
    updateCoverageLevel();

  } else {
    const o=document.createElement("option");
    o.textContent="Select crop and state first";
    triggerSelect.appendChild(o);
  }

  // Ê∏ÖÁ©∫ Coverage Level input
  document.getElementById("coverage").value="";
}

/* === ÂΩì Trigger Level ÊîπÂèòÊó∂Ëá™Âä®ËÆ°ÁÆó Coverage Level (Trigger +20%) === */
function updateCoverageLevel(){
  const triggerVal = parseFloat(document.getElementById("trigger").value);
  if(!isNaN(triggerVal)){
    const coverage = Math.min(triggerVal + 0.20, 1.0); // ‰∏çË∂ÖËøá100%
    document.getElementById("coverage").value = (coverage*100).toFixed(0) + "%";
    document.getElementById("coverage").dataset.value = coverage;
  } else {
    document.getElementById("coverage").value = "";
    document.getElementById("coverage").dataset.value = "";
  }
}
/* === Promo Code ÂàóË°® === */
const promoCodes = {
  "WELCOME": 0.3,
};

let activePromo = { code: null, rate: 0 };

function togglePromoEdit(isEdit) {
  const display = document.getElementById("promoDisplay");
  const edit = document.getElementById("promoEdit");

  if (isEdit) {
    display.style.display = "none";
    edit.style.display = "block";
  } else {
    display.style.display = "flex";
    edit.style.display = "none";
  }
}


function applyPromo() {
  const code = document.getElementById("promoInput").value.trim().toUpperCase();
  const message = document.getElementById("promoMessage");
  const displayText = document.getElementById("promoStatusText");

  if (!code) {
    message.textContent = "Please enter a promo code.";
    message.style.color = "red";
    return;
  }

  if (promoCodes[code]) {
    activePromo = { code, rate: promoCodes[code] };
    message.textContent = `Promo code ${code} applied (${(promoCodes[code] * 100).toFixed(0)}% off)`;
    message.style.color = "green";
    displayText.textContent = `${(promoCodes[code] * 100).toFixed(0)}% off first-year premium. Promo code ${code} applied.`;

    togglePromoEdit(false);

    // ‚úÖ ÊàêÂäüÂêéËá™Âä®Ëß¶ÂèëËÆ°ÁÆóÔºö
    const crop = document.getElementById("crop").value;
    const state = document.getElementById("state").value;
    const area = parseFloat(document.getElementById("area").value);
    const trigger = parseFloat(document.getElementById("trigger").value);
    const coverage = parseFloat(document.getElementById("coverage").dataset.value);

    // ÂÖàÁ°ÆËÆ§Áî®Êà∑ËµÑÊñôÂÆåÊï¥ÔºåÈò≤Ê≠¢Á©∫ÁÆó
    if (crop && state && !isNaN(trigger) && !isNaN(coverage) && !isNaN(area)) {
      calculatePremium();  // ‚úÖ Ëá™Âä®ËÆ°ÁÆó
    }

  } else {
    message.textContent = "Invalid promo code.";
    message.style.color = "red";
    activePromo = { code: null, rate: 0 };
  }
}
/* === Ê†∏ÁÆó‰øùË¥π === */
function calculatePremium(){
  const crop = document.getElementById("crop").value;
  const state = document.getElementById("state").value;
  const area = parseFloat(document.getElementById("area").value);
  const trigger = parseFloat(document.getElementById("trigger").value);
  const coverage = parseFloat(document.getElementById("coverage").dataset.value);
  
  if(!crop || !state || isNaN(trigger) || isNaN(coverage)){
    alert("Please fill all required fields.");
    return;
  }

  // ‚úÖ Êñ∞Ê†ºÂºèÔºöÊåâ trigger level Êü•Êâæ
  const triggerPct = Math.round(trigger * 100).toString();
  const grossData = grossPremiumTable[crop]?.[state];
  
  if(!grossData){
    alert("No data for this crop/state.");
    return;
  }
  
  const gross = grossData[triggerPct];
  
  if(gross === undefined){
    alert(`No premium data for ${crop} in ${state} at ${triggerPct}% trigger level.`);
    return;
  }

  const totalPremium = gross * area;
  const discountRate = activePromo.rate;
  const discountedTotal = totalPremium * (1 - discountRate);

  // Êõ¥Êñ∞ÊèêÁ§∫Êù°
  const promoNotice = document.getElementById("promoNotice");
  const promoNoticeText = document.getElementById("promoNoticeText");
  
  if (discountRate > 0) {
    promoNoticeText.innerHTML =
      `‚úî Promo code <strong>${activePromo.code}</strong> applied ‚Äî ${(discountRate * 100).toFixed(0)}% off total premium.`;
    promoNotice.style.display = "block";
  } else {
    promoNotice.style.display = "none";
  }

  const r = document.getElementById("resultBox");
  r.style.display = "block";
  r.innerHTML = `
    <strong>TOTAL PREMIUM CALCULATOR</strong><br>
    <strong>${crop}</strong> (${state})<br>
    Trigger Level: ${triggerPct}%<br>
    Coverage Level: ${(coverage*100).toFixed(0)}%<br>
    Gross Premium (per ha): <strong>RM ${gross.toLocaleString(undefined,{maximumFractionDigits:2})}</strong><br>
    <div class="highlight-total">
      Total‚ÄØPremium‚ÄØfor‚ÄØ${area}‚ÄØha:&nbsp;
      ${
        discountRate > 0
          ? `<span class="old-price">RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</span>
             <span class="arrow">‚Üí</span>
             <span class="new-price">RM¬†${discountedTotal.toLocaleString(undefined,{maximumFractionDigits:2})}</span>`
          : `<strong>RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</strong>`
      }
    </div>
    ${discountRate>0?`<div class="discount-note">Promo <strong>${activePromo.code}</strong> applied (${(discountRate*100).toFixed(0)}% off)</div>`:""}
  `;
}
</script>
</body>
</html>
