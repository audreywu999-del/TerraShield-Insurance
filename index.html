<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TerraShield Agriculture Insurance</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<style>
:root {
  --gold: #E3A008;
  --dark-gold: #D97706;
  --light-cream: #FFF8E5;
  --text-dark: #2C2A29;
  --bg: #FFFCF7;
}

/* ====== Global Base ====== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Poppins', sans-serif;
}

html { scroll-behavior: smooth; }
body { background: var(--bg); color: var(--text-dark); }

header {
  background: linear-gradient(90deg, var(--gold), var(--dark-gold));
  color: white;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 10;
}

.logo-box { display: flex; align-items: center; gap: 10px; }
.logo { height: 48px; width: auto; }
header h1 { font-size: 1.3rem; letter-spacing: .5px; }

nav a {
  color: white;
  text-decoration: none;
  margin-left: 1.2rem;
  font-weight: 500;
  position: relative;
  padding-bottom: 4px;
  transition: color 0.3s ease;
}
nav a:hover { color: var(--light-cream); }
nav a.active {
  color: var(--light-cream);
  font-weight: 600;
}
nav a.active::after {
  content: "";
  position: absolute;
  left: 0; bottom: 0;
  width: 100%; height: 2px;
  background: var(--light-cream);
}

/* ===== Hero Section ===== */
.hero {
  background: linear-gradient(to right, #FFF7E0, #FFF8E5);
  text-align: center;
  padding: 4rem 1rem 3rem;
}
.hero h2 { font-size: 2.2rem; color: var(--dark-gold); }
.slogan {
  font-style: italic;
  color: var(--dark-gold);
  font-size: 1.5rem;
  font-weight: 500;
  margin-top: .3rem;
  margin-bottom: 1rem;
  opacity: 0;
  transform: translateY(10px);
  animation: fadeInSlogan 1.8s ease forwards;
  animation-delay: .5s;
}
@keyframes fadeInSlogan { to { opacity: 1; transform: translateY(0); } }
.sub-brand {
  font-size: .95rem;
  color: #8b6b2e;
  font-style: italic;
  margin-top: .5rem;
  margin-bottom: 1.2rem;
  opacity: 0;
  transform: translateY(8px);
  animation: fadeInSub 1.6s ease forwards;
  animation-delay: .6s;
  border-top: 1px solid #f3e1b2;
  display: inline-block;
  padding-top: .4rem;
}
@keyframes fadeInSub {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}


/* ===== Containers ===== */
.container {
  max-width: 900px;
  background: white;
  margin: 3rem auto;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.08);
}
h3 { text-align: center; color: var(--dark-gold); margin-bottom: 1.2rem; }

/* ===== Premium Calculator Grid ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 1rem;
}
label { display: block; font-size: .9rem; margin-bottom: .3rem; }
select, input {
  width: 100%;
  padding: .8rem;
  border-radius: 6px;
  border: 1px solid #ddd;
}
button {
  display: block;
  background: var(--dark-gold);
  color: white;
  border: none;
  margin: 1.5rem auto 0;
  padding: .9rem 2.2rem;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.05rem;
}
button:hover {
  background: var(--gold);
  transform: translateY(-2px);
  transition: .2s;
}

/* ===== Result Box ===== */
#resultBox {
  display: none;
  background: var(--light-cream);
  text-align: center;
  margin-top: 1rem;
  padding: 1rem;
  border-radius: 8px;
  color: var(--dark-gold);
  font-weight: 500;
}

/* ===== Promo Card ===== */
.promo-card {
  max-width: 900px;
  margin: 2.5rem auto;
  background: #ffffff;
  border: 1px solid #f1e1bd;
  border-radius: 12px;
  padding: 1.4rem 1.8rem;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
}
.promo-card:hover {
  box-shadow: 0 5px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-2px);
}
.promo-display {
  display: flex;
  justify-content: space-between;   /* Â∑¶ÊñáÂ≠óÂè≥ÊåâÈíÆ */
  align-items: baseline;            /* ‚úÖ ÂØπÈΩêÂà∞ÊñáÂ≠óÁöÑÂ∫ïÁ∫ø */
  padding: 0.9rem 1.2rem;
}

.promo-text {
  color: #4b3b08;
  font-weight: 600;
  font-size: 1.05rem;
  line-height: 1.4;                 /* ‚úÖ Á°Æ‰øùÊñáÂ≠óÊúâÊ†áÂáÜË°åÈ´ò */
}

.promo-edit-btn {
  background: #fff8e5;
  border: 2px solid #d97706;
  color: #d97706;
  font-weight: 700;
  font-size: 0.95rem;
  padding: 0.55rem 1.4rem;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  position: relative;
  top: -1px;                        /* ‚úÖ ÂæÆË∞ÉÔºå‰ΩøÊåâÈíÆ‰∏éÊñáÂ≠ó‰∏≠ÂøÉÂÆåÁæéÂØπÈΩê */
  transition: all 0.25s ease;
}
.promo-edit-btn:hover {
  background: var(--dark-gold);
  color: #fff;
}
.promo-banner {
  display: none;
  background: #ebf7ee;               /* ÊüîÂíåÁªøÂ∫ï */
  border-left: 5px solid #16a34a;    /* Ê∑±ÁªøÁ∫ø */
  border-radius: 6px;
  padding: 0.75rem 1rem;
  margin-top: 1.2rem;
  color: #166534;
  font-weight: 500;
  animation: fadeInPromo 0.5s ease;
}
/* ===== Coverage / Overview Section ===== */
#overview,
#coverage-preview {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;               /* ‚úÖ ÊñáÊú¨Â∑¶ÂØπÈΩê */
}
#coverage-preview { background: #fff9ee; } /* ‰øùÊåÅÊ∑°ÈªÑËâ≤ËÉåÊôØ */
/* ‚úÖ ËÆ©ÊåâÈíÆÂ±Ö‰∏≠ */
#coverage-preview {
  text-align: center; /* Áà∂ÂÆπÂô®Â±Ö‰∏≠ÔºåÊåâÈíÆËá™Âä®Â±Ö‰∏≠ */
}

#coverage-preview p {
  text-align: left; /* ÊÆµËêΩ‰ªçÁÑ∂Â∑¶ÂØπÈΩê */
}
#overview h3,
#coverage-preview h3 {
  text-align: center;
  margin-bottom: 1rem;
}
#overview p,
#coverage-preview p {
  font-size: 1rem;
  line-height: 1.75;
  margin: 0 0 1.5rem 0;
  letter-spacing: 0.3px;
  word-spacing: 1px;
}
#coverage-preview .coverage-btn {
  display: inline-block;
  margin: 0 auto;
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 0.7rem 1.6rem;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 500;
  transition: background 0.3s ease;
}
#coverage-preview .coverage-btn:hover { background: var(--gold); }

/* ===== Contact Section ===== */
#contact {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;
}
/* Force the disclaimer container to left-align */
.disclaimer-bar {
  text-align: left !important;   /* ‚úÖ Áà∂Á∫ßÂº∫Âà∂Â∑¶ÂØπÈΩê */
}
  
/* ===== Disclaimer  ===== */
.disclaimer-bar p {
  font-family: 'Poppins', sans-serif;
  font-style: italic;
  font-size: 0.9rem;
  line-height: 1.6;
  color: var(--dark-gold);
  text-align: left;
  margin-top: 1.5rem;
  margin-bottom: 0;
}

/* ===== Footer ===== */
footer {
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 1.2rem;
  margin-top: 4rem;
  font-size: 0.9rem;
}

/* ===== Responsive ===== */
@media(max-width:600px) {
  header { flex-direction: column; align-items: flex-start; }
  .container { padding: 1.5rem; }
  #overview, #coverage-preview, #contact, .promo-card { padding: 1.5rem; }
  .hero h2 { font-size: 1.7rem; }
  .disclaimer-bar p { font-size: 0.8rem; }
}
/* ===== Promo Edit / Input layout ===== */
.promo-edit {
  padding: 0.9rem 1.2rem;
  border-top: 1px solid #f0e3c4;
  border-radius: 8px;
  background: #fffdf8;
  margin-top: 0.8rem;
}

.promo-edit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  color: var(--dark-gold);
  font-weight: 600;
}

.promo-input-row {
  display: flex;
  gap: 0.8rem;
}

.promo-input-row input {
  flex: 1;
  padding: 0.75rem;
  font-size: 0.95rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  color: #333;
}

.promo-input-row input:focus {
  outline: none;
  border-color: var(--dark-gold);
  box-shadow: 0 0 3px rgba(217, 119, 6, 0.3);
}

.promo-apply,
.promo-cancel {
  background: var(--dark-gold);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.65rem 1.2rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s ease;
}

.promo-apply:hover,
.promo-cancel:hover {
  background: var(--gold);
}

.promo-message {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  font-weight: 500;
}

.arrow {
  font-weight: 500;
  color: #7a621f;
  margin: 0 4px;
}
/* ===== Promo Discount Styling ===== */
.old-price {
  text-decoration: line-through;
  color:  #9ca3af;            /* ÁÅ∞Ëâ≤ */
  margin-right: 0.5rem;
  opacity: 0.8;
}

.new-price {
  color: #166534;            /* ÁªøËâ≤‰ª£Ë°®ËäÇÁúÅ */
  font-weight: 700;
}
/* ===== Highlight Total Premium Line ===== */
.highlight-total {
  background-color: #fff8e1;
  border-radius: 8px;
  padding: 0.7rem 1.2rem;
  margin-top: 0.8rem;
  display: inline-block;
  font-weight: 700;
  color: #b45309;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  font-size: 1rem;
  text-align: center;
  transition: background-color 0.3s ease, transform 0.3s ease;
}
#resultBox .highlight-total {
  display: block;
  width: fit-content;
  margin: 0.8rem auto;
}
.highlight-total:hover {
  background-color: #ffefc6;
  transform: scale(1.03);
}

/* ===== Promo ËØ¥ÊòéË°åÔºàÊ∑°ÂÖ•Âä®ÊïàÔºâ ===== */
#resultBox .discount-note {
  margin-top: 0.6rem;
  font-size: 0.9rem;
  color: #166534 !important;   /* Ê∑±ÁªøËâ≤ */
  font-weight: 500;
  opacity: 0;                   /* Ëµ∑ÂßãÈÄèÊòé */
  transform: translateY(6px);   /* Ëµ∑ÂßãÂæÆ‰∏ãÁßª */
  animation: fadeInUp 0.6s ease forwards;
}

/* Hover ËΩªËâ≤ÂèòÂåñ */
#resultBox .discount-note:hover {
  color: #0f5132 !important;
}

/* Âä®ÁîªÂÖ≥ÈîÆÂ∏ß */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
  
</head>

<body>
<div id="site-header"></div>

<section class="hero">
  <h2>Protecting‚ÄØFarmers,‚ÄØSecuring‚ÄØHarvests</h2>
  <h3 class="slogan">‚ÄúLebih‚ÄØPasti,‚ÄØLebih‚ÄØTenang‚Äù</h3>
  <p class="sub-brand">Powered‚ÄØby‚ÄØ<strong>AgroShield‚ÄØIncome‚ÄØGuard</strong> ‚Äî An‚ÄØIncome‚ÄØProtection‚ÄØPlan‚ÄØby‚ÄØTerraShield‚ÄØInsurance</p>
  <p>Estimate‚ÄØ your‚ÄØ agricultural‚ÄØ insurance‚ÄØ premium‚ÄØ instantly‚ÄØ for‚ÄØ your‚ÄØ crops‚ÄØ in‚ÄØ Malaysia.</p>
</section>

  
<section id="calculator" class="container">
  <h3>Premium Calculator</h3>
  <div class="grid">
    <div>
      <label for="state">State</label>
      <select id="state" onchange="updateCoverageOptions()">
        <option value="">-- Select State --</option>
        <option>Johor</option><option>Kedah</option><option>Kelantan</option><option>Melaka</option>
        <option>Negeri Sembilan</option><option>Pahang</option><option>Perak</option><option>Perlis</option>
        <option>Pulau Pinang</option><option>Sabah</option><option>Sarawak</option><option>Selangor</option>
        <option>Terengganu</option><option>W.P. Kuala Lumpur</option><option>W.P Labuan</option><option>W.P. Putrajaya</option>
      </select>
    </div>
    <div>
      <label for="district">District</label>
      <input id="district" placeholder="e.g. Kota Setar" />
    </div>
    <div>
      <label for="crop">Crop</label>
      <select id="crop" onchange="updateCoverageOptions()">
        <option value="">-- Select Crop --</option>
        <option>Oil Palm</option><option>Rubber</option>
        <option>Cocoa</option><option>Durian</option><option>Coconut</option>
        <option>Pineapple</option><option>Mango</option>
      </select>
    </div>
    <!-- ‚úÖ ÁßªÈô§‰∫Ü Expected Yield -->
    <div>
      <label for="area">Area (ha)</label>
      <input id="area" type="number" value="10" step="0.1" />
    </div>
    <div>
      <label for="trigger">Trigger Level</label>
      <select id="trigger" onchange="updateCoverageLevel()">
        <option value="">Select crop/state first</option>
      </select>
    </div>
    <div>
      <label for="coverage">Coverage Level</label>
      <input id="coverage" type="text" readonly placeholder="Auto‚Äëcalculated" />   
    </div>
    <p style="font-size:0.9rem;color:#8b6b2e;margin-top:0.3rem;">
    üí° Coverage‚ÄØis‚ÄØalways‚ÄØ<strong>20%‚ÄØhigher</strong>‚ÄØthan‚ÄØthe‚ÄØtrigger‚ÄØlevel.‚ÄØ
    This‚ÄØmeans‚ÄØonce‚ÄØyour‚ÄØloss‚ÄØreaches‚ÄØthe‚ÄØtrigger‚ÄØpoint,‚ÄØTerraShield‚ÄØwill‚ÄØcover‚ÄØup‚ÄØto‚ÄØ20%‚ÄØmore‚ÄØto‚ÄØprotect‚ÄØyou‚ÄØbetter.
    </p> 
  </div>
  <button onclick="calculatePremium()">Calculate</button>
  <div id="promoNotice" class="promo-banner">
    <span id="promoNoticeText"></span>
  </div>
  <div id="resultBox"></div>
  <div class="disclaimer-bar">
  <p>
  The above premiums are calculated at the standard premium rate and are for reference only.
  The actual premiums paid must include the premium levy collected by the Insurance Authority.
  </p>
  </div>

</section>
<!-- Promo Section -->
<div id="promoContainer" class="promo-card">
  <!-- Â±ïÁ§∫Ê®°Âºè -->
  <div id="promoDisplay" class="promo-display">
    <div class="promo-text">
      <span id="promoStatusText">No promotion code applied.</span>
    </div>
    <button class="promo-edit-btn" onclick="togglePromoEdit(true)">Edit Promo Code</button>
  </div>

  <!-- ÁºñËæëÊ®°Âºè -->
  <div id="promoEdit" class="promo-edit" style="display:none;">
    <div class="promo-edit-header">
      <span>Enter your Promotion Code</span>
    </div>
    <div class="promo-input-row">
      <input id="promoInput" placeholder="e.g.‚ÄØWELCOME" />
      <button class="promo-apply" onclick="applyPromo()">Apply</button>
    </div>
    <div id="promoMessage" class="promo-message"></div>
  </div>
</div>
  
<!-- ‚¨áÔ∏è ÊîæÂú® Footer ‰∏äÊñπ -->
<section id="overview" class="container">
  <h3>About‚ÄØTerraShield</h3>
  <p>
    TerraShield empowers Malaysian farmers‚ÄØwith reliable,‚ÄØdata‚Äëdriven‚ÄØinsurance tools to make crop protection‚ÄØ
    transparent and‚ÄØaffordable for‚ÄØsustainable‚ÄØgrowth.
  </p>
</section>

<section id="coverage-preview" class="container coverage-preview">
  <h3>Crop‚ÄØ&‚ÄØRisk‚ÄØCoverage‚ÄØOverview</h3>
  <p>
    Learn which crops and‚ÄØrisks are included in our‚ÄØMalaysian‚ÄØAgricultural‚ÄØInsurance Program¬†‚Äî from rice, 
    durian,‚ÄØand oil palm to‚ÄØprotection‚ÄØfrom floods,‚ÄØdroughts, and‚ÄØtyphoons.
  </p>
  <a class="coverage-btn" href="./coverage.html">View‚ÄØFull‚ÄØCoverage¬†‚Üí</a>
</section>

<section id="contact" class="container">
  <h3>Contact‚ÄØUs</h3>
  <p>
    Email:‚ÄØ<a href="mailto:info@terrashield.my">info@terrashield.my</a><br/>
    Kuala‚ÄØLumpur,‚ÄØMalaysia
  </p>
</section>

<footer>¬©‚ÄØ2025‚ÄØTerraShield‚ÄØAgriculture‚ÄØInsurance‚ÄØ|‚ÄØAll‚ÄØRights‚ÄØReserved</footer>

<script>
fetch('./header.html?v=20251125')
  .then(r=>r.text())
  .then(h=>{document.getElementById('site-header').innerHTML=h;
    const p=location.pathname.split("/").pop()||"index.html";
    document.querySelectorAll("nav a").forEach(a=>{if(a.href.includes(p))a.classList.add("active");});
  }).catch(console.error);

/* ===== Coverage limits (for dropdown) ===== */
const coverageLimits = {
  "Oil Palm": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Durian": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,80], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Rubber": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Selangor":[50,70], "Terengganu":[50,70],
    "Sabah":[50,80], "Sarawak":[50,80], "W.P. Kuala Lumpur":[50,70],
    "W.P Labuan":[50,70], "W.P. Putrajaya":[50,70]
  },

  "Paddy (Rice)": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,80], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Pineapple": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,90],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Cocoa": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Coconut": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Mango": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  }
};

/* === ÂÖ®ÈÉ®‰ΩúÁâ©ÁöÑ Gross Premium Ë°®Ê†º === */
const grossPremiumTable = {

  "Cocoa": {
    "Johor": {"50": 128.17, "55": 140.74, "60": 151.14, "65": 158.64, "70": 162.47},
    "Kedah": {"50": 125.97, "55": 138.32, "60": 148.54, "65": 155.91, "70": 159.68, "75": 159.13, "80": 153.59, "85": 160.66, "90": 165.89},
    "Kelantan": {"50": 128.17, "55": 140.74, "60": 151.14, "65": 158.64, "70": 162.47},
    "Melaka": {"50": 127.75, "55": 140.28, "60": 150.65, "65": 158.12, "70": 161.94},
    "Negeri Sembilan": {"50": 127.75, "55": 140.28, "60": 150.65, "65": 158.12, "70": 161.94},
    "Pahang": {"50": 132.16, "55": 145.11, "60": 155.84, "65": 163.57, "70": 167.53},
    "Perak": {"50": 125.97, "55": 138.32, "60": 148.54, "65": 155.91, "70": 159.68, "75": 159.13, "80": 153.59, "85": 160.66, "90": 165.89},
    "Perlis": {"50": 127.75, "55": 140.28, "60": 150.65, "65": 158.12, "70": 161.94},
    "Pulau Pinang": {"50": 131.74, "55": 144.65, "60": 155.35, "65": 163.05, "70": 166.99},
    "Sabah": {"50": 136.14, "55": 149.49, "60": 160.54, "65": 168.5, "70": 172.58, "75": 171.98, "80": 165.99},
    "Sarawak": {"50": 133.94, "55": 147.07, "60": 157.94, "65": 165.78, "70": 169.78, "75": 169.2, "80": 163.3},
    "Selangor": {"50": 129.96, "55": 142.7, "60": 153.24, "65": 160.84, "70": 164.73},
    "Terengganu": {"50": 128.17, "55": 140.74, "60": 151.14, "65": 158.64, "70": 162.47},
    "W.P Labuan": {"50": 131.74, "55": 144.65, "60": 155.35, "65": 163.05, "70": 166.99},
    "W.P. Kuala Lumpur": {"50": 131.74, "55": 144.65, "60": 155.35, "65": 163.05, "70": 166.99},
    "W.P. Putrajaya": {"50": 131.74, "55": 144.65, "60": 155.35, "65": 163.05, "70": 166.99}
    },
  "Coconut": {
    "Johor": {"50": 0.14, "55": 0.72, "60": 3.05, "65": 10.69, "70": 30.88},
    "Kedah": {"50": 0.14, "55": 0.71, "60": 3, "65": 10.51, "70": 30.35, "75": 71.41, "80": 133.54, "85": 245.55, "90": 379.41},
    "Kelantan": {"50": 0.14, "55": 0.72, "60": 3.05, "65": 10.69, "70": 30.88},
    "Melaka": {"50": 0.14, "55": 0.72, "60": 3.04, "65": 10.66, "70": 30.78},
    "Negeri Sembilan": {"50": 0.14, "55": 0.72, "60": 3.04, "65": 10.66, "70": 30.78},
    "Pahang": {"50": 0.15, "55": 0.75, "60": 3.15, "65": 11.02, "70": 31.84},
    "Perak": {"50": 0.14, "55": 0.71, "60": 3, "65": 10.51, "70": 30.35, "75": 71.41, "80": 133.54, "85": 245.55, "90": 379.41},
    "Perlis": {"50": 0.14, "55": 0.72, "60": 3.04, "65": 10.66, "70": 30.78},
    "Pulau Pinang": {"50": 0.15, "55": 0.74, "60": 3.14, "65": 10.99, "70": 31.74},
    "Sabah": {"50": 0.15, "55": 0.77, "60": 3.24, "65": 11.36, "70": 32.8, "75": 77.18, "80": 144.32},
    "Sarawak": {"50": 0.15, "55": 0.76, "60": 3.19, "65": 11.17, "70": 32.27, "75": 75.93, "80": 141.99},
    "Selangor": {"50": 0.14, "55": 0.73, "60": 3.09, "65": 10.84, "70": 31.31},
    "Terengganu": {"50": 0.14, "55": 0.72, "60": 3.05, "65": 10.69, "70": 30.88},
    "W.P Labuan": {"50": 0.15, "55": 0.74, "60": 3.14, "65": 10.99, "70": 31.74},
    "W.P. Kuala Lumpur": {"50": 0.15, "55": 0.74, "60": 3.14, "65": 10.99, "70": 31.74},
    "W.P. Putrajaya": {"50": 0.15, "55": 0.74, "60": 3.14, "65": 10.99, "70": 31.74}
    },
  "Durian": {
    "Johor": {"50": 0.33, "55": 2.28, "60": 12.76, "65": 57.24, "70": 204.85},
    "Kedah": {"50": 0.32, "55": 2.24, "60": 12.54, "65": 56.26, "70": 201.32, "75": 567.53, "80": 1227.37, "85": 2533, "90": 4250.01},
    "Kelantan": {"50": 0.34, "55": 2.35, "60": 13.15, "65": 59.02, "70": 211.21},
    "Melaka": {"50": 0.33, "55": 2.28, "60": 12.72, "65": 57.05, "70": 204.17},
    "Negeri Sembilan": {"50": 0.33, "55": 2.28, "60": 12.72, "65": 57.05, "70": 204.17},
    "Pahang": {"50": 0.34, "55": 2.35, "60": 13.15, "65": 59.02, "70": 211.21},
    "Perak": {"50": 0.34, "55": 2.39, "60": 13.33, "65": 59.82, "70": 214.06, "75": 603.44, "80": 1305.03},
    "Perlis": {"50": 0.33, "55": 2.28, "60": 12.72, "65": 57.05, "70": 204.17},
    "Pulau Pinang": {"50": 0.33, "55": 2.28, "60": 12.72, "65": 57.05, "70": 204.17},
    "Sabah": {"50": 0.35, "55": 2.43, "60": 13.55, "65": 60.8, "70": 217.58, "75": 613.36, "80": 1326.5},
    "Sarawak": {"50": 0.34, "55": 2.39, "60": 13.33, "65": 59.82, "70": 214.06, "75": 603.44, "80": 1305.03},
    "Selangor": {"50": 0.33, "55": 2.31, "60": 12.93, "65": 58.04, "70": 207.69},
    "Terengganu": {"50": 0.33, "55": 2.28, "60": 12.76, "65": 57.24, "70": 204.85},
    "W.P Labuan": {"50": 0.34, "55": 2.35, "60": 13.11, "65": 58.83, "70": 210.54},
    "W.P. Kuala Lumpur": {"50": 0.34, "55": 2.35, "60": 13.11, "65": 58.83, "70": 210.54},
    "W.P. Putrajaya": {"50": 0.34, "55": 2.35, "60": 13.11, "65": 58.83, "70": 210.54}
    },
  "Mango": {
    "Johor": {"50": 6032.24, "55": 6387.88, "60": 6641.11, "65": 6777.08, "70": 6781.7},
    "Kedah": {"50": 5928.56, "55": 6278.09, "60": 6526.97, "65": 6660.59, "70": 6665.14, "75": 6527.95, "80": 6237.88, "85": 6436.09, "90": 6580.36},
    "Kelantan": {"50": 6032.24, "55": 6387.88, "60": 6641.11, "65": 6777.08, "70": 6781.7},
    "Melaka": {"50": 5824.87, "55": 6168.29, "60": 6412.82, "65": 6544.11, "70": 6548.57, "75": 6413.79, "80": 6128.79, "85": 6323.53, "90": 6465.28},
    "Negeri Sembilan": {"50": 6012.43, "55": 6366.91, "60": 6619.31, "65": 6754.83, "70": 6759.44},
    "Pahang": {"50": 6219.8, "55": 6586.5, "60": 6847.61, "65": 6987.8, "70": 6992.57},
    "Perak": {"50": 5928.56, "55": 6278.09, "60": 6526.97, "65": 6660.59, "70": 6665.14, "75": 6527.95, "80": 6237.88, "85": 6436.09, "90": 6580.36},
    "Perlis": {"50": 6012.43, "55": 6366.91, "60": 6619.31, "65": 6754.83, "70": 6759.44},
    "Pulau Pinang": {"50": 6199.99, "55": 6565.53, "60": 6825.8, "65": 6965.55, "70": 6970.3},
    "Sabah": {"50": 6407.36, "55": 6785.12, "60": 7054.1, "65": 7198.52, "70": 7203.43, "75": 7055.17, "80": 6741.67},
    "Sarawak": {"50": 6303.68, "55": 6675.32, "60": 6939.95, "65": 7082.03, "70": 7086.87, "75": 6941, "80": 6632.58},
    "Selangor": {"50": 6116.12, "55": 6476.7, "60": 6733.46, "65": 6871.31, "70": 6876},
    "Terengganu": {"50": 6032.24, "55": 6387.88, "60": 6641.11, "65": 6777.08, "70": 6781.7},
    "W.P Labuan": {"50": 6199.99, "55": 6565.53, "60": 6825.8, "65": 6965.55, "70": 6970.3},
    "W.P. Kuala Lumpur": {"50": 6199.99, "55": 6565.53, "60": 6825.8, "65": 6965.55, "70": 6970.3},
    "W.P. Putrajaya": {"50": 6199.99, "55": 6565.53, "60": 6825.8, "65": 6965.55, "70": 6970.3}
    },
  "Oil Palm": {
    "Johor": {"50": 1359.86, "55": 1608.13, "60": 1846.11, "65": 2054.13, "70": 2209.27},
    "Kedah": {"50": 1336.49, "55": 1580.49, "60": 1814.38, "65": 2018.82, "70": 2171.3, "75": 2247.39, "80": 2222.38, "85": 2391.48, "90": 2519.93},
    "Kelantan": {"50": 1402.14, "55": 1658.13, "60": 1903.51, "65": 2118, "70": 2277.97},
    "Melaka": {"50": 1355.4, "55": 1602.85, "60": 1840.05, "65": 2047.39, "70": 2202.02},
    "Negeri Sembilan": {"50": 1313.11, "55": 1552.85, "60": 1782.65, "65": 1983.52, "70": 2133.33, "75": 2208.08, "80": 2183.51, "85": 2349.65, "90": 2475.86},
    "Pahang": {"50": 1402.14, "55": 1658.13, "60": 1903.51, "65": 2118, "70": 2277.97},
    "Perak": {"50": 1336.49, "55": 1580.49, "60": 1814.38, "65": 2018.82, "70": 2171.3, "75": 2247.39, "80": 2222.38, "85": 2391.48, "90": 2519.93},
    "Perlis": {"50": 1355.4, "55": 1602.85, "60": 1840.05, "65": 2047.39, "70": 2202.02},
    "Pulau Pinang": {"50": 1397.68, "55": 1652.85, "60": 1897.45, "65": 2111.25, "70": 2270.71},
    "Sabah": {"50": 1444.43, "55": 1708.13, "60": 1960.92, "65": 2181.87, "70": 2346.66, "75": 2428.89, "80": 2401.86},
    "Sarawak": {"50": 1421.05, "55": 1680.49, "60": 1929.19, "65": 2146.56, "70": 2308.69, "75": 2389.59, "80": 2363},
    "Selangor": {"50": 1378.77, "55": 1630.49, "60": 1871.78, "65": 2082.69, "70": 2239.99},
    "Terengganu": {"50": 1359.86, "55": 1608.13, "60": 1846.11, "65": 2054.13, "70": 2209.27},
    "W.P Labuan": {"50": 1397.68, "55": 1652.85, "60": 1897.45, "65": 2111.25, "70": 2270.71},
    "W.P. Kuala Lumpur": {"50": 1397.68, "55": 1652.85, "60": 1897.45, "65": 2111.25, "70": 2270.71},
    "W.P. Putrajaya": {"50": 1397.68, "55": 1652.85, "60": 1897.45, "65": 2111.25, "70": 2270.71}
    },
  "Paddy (Rice)": {
    "Johor": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "Kedah": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0, "75": 0, "80": 0, "85": 0, "90": 0.66},
    "Kelantan": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0, "75": 0, "80": 0},
    "Melaka": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0, "75": 0, "80": 0, "85": 0, "90": 0.65},
    "Negeri Sembilan": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "Pahang": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0, "75": 0, "80": 0},
    "Perak": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "Perlis": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "Pulau Pinang": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "Sabah": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0, "75": 0, "80": 0},
    "Sarawak": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0, "75": 0, "80": 0},
    "Selangor": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "Terengganu": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "W.P Labuan": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "W.P. Kuala Lumpur": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0},
    "W.P. Putrajaya": {"50": 0, "55": 0, "60": 0, "65": 0, "70": 0}
    },
  "Pineapple": {
    "Johor": {"50": 36.14, "55": 91.86, "60": 209.17, "65": 425.13, "70": 766.83},
    "Kedah": {"50": 35.52, "55": 90.28, "60": 205.57, "65": 417.83, "70": 753.65, "75": 1194.03, "80": 1628.67, "85": 2323.86, "90": 2995.57},
    "Kelantan": {"50": 37.27, "55": 94.72, "60": 215.67, "65": 438.35, "70": 790.67},
    "Melaka": {"50": 34.9, "55": 88.71, "60": 201.98, "65": 410.52, "70": 740.47, "75": 1173.14, "80": 1600.19, "85": 2283.22, "90": 2943.18},
    "Negeri Sembilan": {"50": 37.15, "55": 94.42, "60": 214.98, "65": 436.96, "70": 788.15},
    "Pahang": {"50": 38.39, "55": 97.58, "60": 222.17, "65": 451.57, "70": 814.51, "75": 1290.46, "80": 1760.21},
    "Perak": {"50": 35.52, "55": 90.28, "60": 205.57, "65": 417.83, "70": 753.65, "75": 1194.03, "80": 1628.67, "85": 2323.86, "90": 2995.57},
    "Perlis": {"50": 36.02, "55": 91.56, "60": 208.48, "65": 423.74, "70": 764.31},
    "Pulau Pinang": {"50": 37.15, "55": 94.42, "60": 214.98, "65": 436.96, "70": 788.15},
    "Sabah": {"50": 38.39, "55": 97.58, "60": 222.17, "65": 451.57, "70": 814.51, "75": 1290.46, "80": 1760.21},
    "Sarawak": {"50": 37.77, "55": 96, "60": 218.58, "65": 444.26, "70": 801.33, "75": 1269.58, "80": 1731.72},
    "Selangor": {"50": 35.52, "55": 90.28, "60": 205.57, "65": 417.83, "70": 753.65, "75": 1194.03, "80": 1628.67, "85": 2323.86, "90": 2995.57},
    "Terengganu": {"50": 37.27, "55": 94.72, "60": 215.67, "65": 438.35, "70": 790.67},
    "W.P Labuan": {"50": 37.15, "55": 94.42, "60": 214.98, "65": 436.96, "70": 788.15},
    "W.P. Kuala Lumpur": {"50": 37.15, "55": 94.42, "60": 214.98, "65": 436.96, "70": 788.15},
    "W.P. Putrajaya": {"50": 37.15, "55": 94.42, "60": 214.98, "65": 436.96, "70": 788.15}
    },
  "Rubber": {
    "Johor": {"50": 320.26, "55": 339.66, "60": 353.62, "65": 361.29, "70": 361.89},
    "Kedah": {"50": 314.75, "55": 333.83, "60": 347.54, "65": 355.08, "70": 355.67, "75": 348.6, "80": 333.24, "85": 344.03, "90": 351.89},
    "Kelantan": {"50": 330.21, "55": 350.23, "60": 364.61, "65": 372.52, "70": 373.14},
    "Melaka": {"50": 319.2, "55": 338.55, "60": 352.46, "65": 360.1, "70": 360.7},
    "Negeri Sembilan": {"50": 309.25, "55": 327.99, "60": 341.46, "65": 348.87, "70": 349.45, "75": 342.5, "80": 327.41, "85": 338.01, "90": 345.73},
    "Pahang": {"50": 330.21, "55": 350.23, "60": 364.61, "65": 372.52, "70": 373.14},
    "Perak": {"50": 324.71, "55": 344.39, "60": 358.54, "65": 366.31, "70": 366.92},
    "Perlis": {"50": 319.2, "55": 338.55, "60": 352.46, "65": 360.1, "70": 360.7},
    "Pulau Pinang": {"50": 329.16, "55": 349.11, "60": 363.45, "65": 371.34, "70": 371.95},
    "Sabah": {"50": 340.17, "55": 360.79, "60": 375.61, "65": 383.76, "70": 384.39, "75": 376.75, "80": 360.15},
    "Sarawak": {"50": 334.67, "55": 354.95, "60": 369.53, "65": 377.55, "70": 378.17, "75": 370.65, "80": 354.32},
    "Selangor": {"50": 324.71, "55": 344.39, "60": 358.54, "65": 366.31, "70": 366.92},
    "Terengganu": {"50": 320.26, "55": 339.66, "60": 353.62, "65": 361.29, "70": 361.89},
    "W.P Labuan": {"50": 329.16, "55": 349.11, "60": 363.45, "65": 371.34, "70": 371.95},
    "W.P. Kuala Lumpur": {"50": 329.16, "55": 349.11, "60": 363.45, "65": 371.34, "70": 371.95},
    "W.P. Putrajaya": {"50": 329.16, "55": 349.11, "60": 363.45, "65": 371.34, "70": 371.95}
  }
};
/* === Êõ¥Êñ∞ Trigger Level ‰∏ãÊãâÈÄâÈ°π === */
function updateCoverageOptions(){
  const s = document.getElementById("state").value;
  const c = document.getElementById("crop").value;
  const triggerSelect = document.getElementById("trigger");

  triggerSelect.innerHTML = "";

  if(s && c && coverageLimits[c] && coverageLimits[c][s]){
    const [min,max] = coverageLimits[c][s];
    for(let i=min;i<=max;i+=5){
      const o = document.createElement("option");
      o.value = i / 100;
      o.textContent = i + "%";
      triggerSelect.appendChild(o);
    }

    // üü¢ Ëá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÈÄâÈ°πÂπ∂Ëß¶Âèë coverage ËÆ°ÁÆó
    triggerSelect.selectedIndex = 0;
    updateCoverageLevel();

  } else {
    const o=document.createElement("option");
    o.textContent="Select crop and state first";
    triggerSelect.appendChild(o);
  }

  // Ê∏ÖÁ©∫ Coverage Level input
  document.getElementById("coverage").value="";
}

/* === ÂΩì Trigger Level ÊîπÂèòÊó∂Ëá™Âä®ËÆ°ÁÆó Coverage Level (Trigger +20%) === */
function updateCoverageLevel(){
  const triggerVal = parseFloat(document.getElementById("trigger").value);
  if(!isNaN(triggerVal)){
    const coverage = Math.min(triggerVal + 0.20, 1.0); // ‰∏çË∂ÖËøá100%
    document.getElementById("coverage").value = (coverage*100).toFixed(0) + "%";
    document.getElementById("coverage").dataset.value = coverage;
  } else {
    document.getElementById("coverage").value = "";
    document.getElementById("coverage").dataset.value = "";
  }
}
/* === Promo Code ÂàóË°® === */
const promoCodes = {
  "WELCOME": 0.3,
};

let activePromo = { code: null, rate: 0 };

function togglePromoEdit(isEdit) {
  const display = document.getElementById("promoDisplay");
  const edit = document.getElementById("promoEdit");

  if (isEdit) {
    display.style.display = "none";
    edit.style.display = "block";
  } else {
    display.style.display = "flex";
    edit.style.display = "none";
  }
}


function applyPromo() {
  const code = document.getElementById("promoInput").value.trim().toUpperCase();
  const message = document.getElementById("promoMessage");
  const displayText = document.getElementById("promoStatusText");

  if (!code) {
    message.textContent = "Please enter a promo code.";
    message.style.color = "red";
    return;
  }

  if (promoCodes[code]) {
    activePromo = { code, rate: promoCodes[code] };
    message.textContent = `Promo code ${code} applied (${(promoCodes[code] * 100).toFixed(0)}% off)`;
    message.style.color = "green";
    displayText.textContent = `${(promoCodes[code] * 100).toFixed(0)}% off first-year premium. Promo code ${code} applied.`;

    togglePromoEdit(false);

    // ‚úÖ ÊàêÂäüÂêéËá™Âä®Ëß¶ÂèëËÆ°ÁÆóÔºö
    const crop = document.getElementById("crop").value;
    const state = document.getElementById("state").value;
    const area = parseFloat(document.getElementById("area").value);
    const trigger = parseFloat(document.getElementById("trigger").value);
    const coverage = parseFloat(document.getElementById("coverage").dataset.value);

    // ÂÖàÁ°ÆËÆ§Áî®Êà∑ËµÑÊñôÂÆåÊï¥ÔºåÈò≤Ê≠¢Á©∫ÁÆó
    if (crop && state && !isNaN(trigger) && !isNaN(coverage) && !isNaN(area)) {
      calculatePremium();  // ‚úÖ Ëá™Âä®ËÆ°ÁÆó
    }

  } else {
    message.textContent = "Invalid promo code.";
    message.style.color = "red";
    activePromo = { code: null, rate: 0 };
  }
}
/* === Ê†∏ÁÆó‰øùË¥π === */
function calculatePremium(){
  const crop = document.getElementById("crop").value;
  const state = document.getElementById("state").value;
  const area = parseFloat(document.getElementById("area").value);
  const trigger = parseFloat(document.getElementById("trigger").value);
  const coverage = parseFloat(document.getElementById("coverage").dataset.value);
  
  if(!crop || !state || isNaN(trigger) || isNaN(coverage)){
    alert("Please fill all required fields.");
    return;
  }

  // ‚úÖ Êñ∞Ê†ºÂºèÔºöÊåâ trigger level Êü•Êâæ
  const triggerPct = Math.round(trigger * 100).toString();
  const grossData = grossPremiumTable[crop]?.[state];
  
  if(!grossData){
    alert("No data for this crop/state.");
    return;
  }
  
  const gross = grossData[triggerPct];
  
  if(gross === undefined){
    alert(`No premium data for ${crop} in ${state} at ${triggerPct}% trigger level.`);
    return;
  }

  const totalPremium = gross * area;
  const discountRate = activePromo.rate;
  const discountedTotal = totalPremium * (1 - discountRate);

  // Êõ¥Êñ∞ÊèêÁ§∫Êù°
  const promoNotice = document.getElementById("promoNotice");
  const promoNoticeText = document.getElementById("promoNoticeText");
  
  if (discountRate > 0) {
    promoNoticeText.innerHTML =
      `‚úî Promo code <strong>${activePromo.code}</strong> applied ‚Äî ${(discountRate * 100).toFixed(0)}% off total premium.`;
    promoNotice.style.display = "block";
  } else {
    promoNotice.style.display = "none";
  }

  const r = document.getElementById("resultBox");
  r.style.display = "block";
  r.innerHTML = `
    <strong>TOTAL PREMIUM CALCULATOR</strong><br>
    <strong>${crop}</strong> (${state})<br>
    Trigger Level: ${triggerPct}%<br>
    Coverage Level: ${(coverage*100).toFixed(0)}%<br>
    Gross Premium (per ha): <strong>RM ${gross.toLocaleString(undefined,{maximumFractionDigits:2})}</strong><br>
    <div class="highlight-total">
      Total‚ÄØPremium‚ÄØfor‚ÄØ${area}‚ÄØha:&nbsp;
      ${
        discountRate > 0
          ? `<span class="old-price">RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</span>
             <span class="arrow">‚Üí</span>
             <span class="new-price">RM¬†${discountedTotal.toLocaleString(undefined,{maximumFractionDigits:2})}</span>`
          : `<strong>RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</strong>`
      }
    </div>
    ${discountRate>0?`<div class="discount-note">Promo <strong>${activePromo.code}</strong> applied (${(discountRate*100).toFixed(0)}% off)</div>`:""}
  `;
}
</script>
</body>
</html>
