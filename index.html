<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TerraShield Agriculture Insurance</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<style>
:root {
  --gold:#E3A008; --dark-gold:#D97706; --light-cream:#FFF8E5; --text-dark:#2C2A29; --bg:#FFFCF7;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text-dark);}
header{background:linear-gradient(90deg,var(--gold),var(--dark-gold));color:white;padding:1rem 1.5rem;
  display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:10;}
.logo-box{display:flex;align-items:center;gap:10px;}
.logo{height:48px;width:auto;}
header h1{font-size:1.3rem;letter-spacing:.5px;}
nav a{color:white;text-decoration:none;margin-left:1.2rem;font-weight:500;position:relative;padding-bottom:4px;
  transition:color 0.3s ease;}
nav a:hover{color:var(--light-cream);}
nav a.active{color:var(--light-cream);font-weight:600;}
nav a.active::after{content:"";position:absolute;left:0;bottom:0;width:100%;height:2px;background:var(--light-cream);}
.hero{background:linear-gradient(to right,#FFF7E0,#FFF8E5);text-align:center;padding:4rem 1rem 3rem;}
.hero h2{font-size:2.2rem;color:var(--dark-gold);}
.slogan{font-style:italic;color:var(--dark-gold);font-size:1.5rem;font-weight:500;margin-top:.3rem;margin-bottom:1rem;
  opacity:0;transform:translateY(10px);animation:fadeInSlogan 1.8s ease forwards;animation-delay:.5s;}
@keyframes fadeInSlogan{to{opacity:1;transform:translateY(0);}}
.sub-brand{font-size:.95rem;color:#8b6b2e;font-style:italic;margin-top:.5rem;margin-bottom:1.2rem;
  opacity:0;transform:translateY(8px);animation:fadeInSub 1.6s ease forwards;animation-delay:.6s;
  border-top:1px solid #f3e1b2;display:inline-block;padding-top:.4rem;}
@keyframes fadeInSub{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
.container{max-width:900px;background:white;margin:3rem auto;padding:2rem;border-radius:12px;
  box-shadow:0 4px 18px rgba(0,0,0,.08);}
h3{text-align:center;color:var(--dark-gold);margin-bottom:1.2rem;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:1rem;}
label{display:block;font-size:.9rem;margin-bottom:.3rem;}
select,input{width:100%;padding:.8rem;border-radius:6px;border:1px solid #ddd;}
button{display:block;background:var(--dark-gold);color:white;border:none;margin:1.5rem auto 0;
  padding:.9rem 2.2rem;border-radius:8px;cursor:pointer;font-size:1.05rem;}
button:hover{background:var(--gold);transform:translateY(-2px);transition:.2s;}
#resultBox{display:none;background:var(--light-cream);text-align:center;margin-top:1rem;padding:1rem;
  border-radius:8px;color:var(--dark-gold);font-weight:500;}
.disclaimer-bar{color:var(--dark-gold);font-family:"Georgia","Times New Roman",serif;font-style:italic;
  font-size:.7rem;line-height:1.3;margin-top:1.5rem;}
.coverage-preview{text-align:center;background:#fff9ee;}
.coverage-preview p{max-width:650px;margin:0 auto 1.4rem;}
.coverage-btn{display:inline-block;background:var(--dark-gold);color:white;padding:.7rem 1.6rem;
  border-radius:8px;text-decoration:none;font-weight:500;transition:background .3s ease;}
.coverage-btn:hover{background:var(--gold);}
footer{text-align:center;background:var(--dark-gold);color:white;padding:1.2rem;margin-top:4rem;font-size:.9rem;}
@media(max-width:600px){header{flex-direction:column;align-items:flex-start;}.container{padding:1.5rem;}.hero h2{font-size:1.7rem;}}
@keyframes fadeInPromo {
  from { opacity: 0; transform: translateY(-5px); }
  to { opacity: 1; transform: translateY(0); }
}
/* ===== Beautiful Promo Card Styling ===== */
.promo-card {
  max-width: 900px;
  margin: 2.5rem auto;
  background: #ffffff;
  border: 1px solid #f1e1bd;
  border-radius: 12px;
  padding: 1.4rem 1.8rem;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
}
.promo-card:hover {
  box-shadow: 0 5px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-2px);
}

/* === Promo ä¸€è¡ŒçœŸæ­£è§†è§‰å¯¹é½ === */
.promo-display {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.9rem 1.2rem;        /* ç¨é«˜ä¸€ç‚¹ï¼Œè®©ç©ºé—´å‡è¡¡ */
  gap: 1rem;
}

/* âœ… å·¦è¾¹æ–‡å­—éƒ¨åˆ†ç²¾ç¡®å¾®è°ƒ */
.promo-text {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: #4b3b08;
  font-weight: 600;
  font-size: 1.05rem;
  line-height: 1.3;
  letter-spacing: 0.3px;
  position: relative;
  top: 1px;                      /* âœ… å‘ä¸‹å¾®è°ƒ 1px ä¿è¯ä¸æŒ‰é’®è§†è§‰é½å¹³ */
}

.promo-text::before {
  content: "ğŸŸï¸";
  display: inline-block;
  font-size: 1.15rem;
  transform: translateY(2px);    /* âœ… emoji ä¸‹ç§»ä¸€ç‚¹ */
}

/* âœ… å³ä¾§æŒ‰é’®å‚ç›´å±…ä¸­ + å¾®è°ƒ */
.promo-edit-btn {
  background: #fff8e5;
  border: 2px solid #d97706;
  color: #d97706;
  font-weight: 700;
  font-size: 0.95rem;
  padding: 0.55rem 1.4rem;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.25s ease;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  line-height: 1.2;
  position: relative;
  top: -1px;                     /* âœ… å‘ä¸Šå¾®è°ƒ 1pxï¼Œä¸å·¦è¾¹åº•çº¿å¯¹é½ */
}

.promo-edit-btn:hover {
  background: var(--dark-gold);
  color: #fff;
}
/* ==== ä¿®æ­£ç‰ˆï¼šPromo ç¼–è¾‘é¡µæ ‡é¢˜å®Œç¾å¯¹é½ ==== */
.promo-edit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;       /* å¤§ä½“å±…ä¸­ */
  font-weight: 600;
  color: #4b3b08;
  margin-bottom: 0.9rem;
  letter-spacing: 0.3px;
  line-height: 1.4;
}

/* å·¦è¾¹â€œEnter your Promo Codeâ€éƒ¨åˆ† */
.promo-edit-header span {
  display: inline-flex;
  align-items: center;       /* emoji ä¸æ–‡å­—å‚ç›´å±…ä¸­ */
  gap: 8px;
  position: relative;
  top: 1px;                  /* ğŸ‘ˆ æ•´ç»„å¾®ä¸‹è°ƒ 1pxï¼Œä½¿å·¦ä¾§ä¸å³è¾¹Cancelå¤„äºä¸€æ¡çº¿ä¸Š */
}

/* è°ƒæ•´ emoji ä¸æ–‡å­—æ¯”ä¾‹å’Œä½ç½® */
.promo-edit-header span::before {
  content: "";
  display: inline-block;
  font-size: 1.2rem;
  transform: translateY(2px);  /* ğŸ‘ˆ emoji ä¸‹ç§»ä¸€ç‚¹ */
}

/* å³è¾¹ Cancel æŒ‰é’®å¾®è°ƒé«˜åº¦åŒ¹é… */
.promo-cancel {
  background: none;
  border: none;
  color: #d97706;
  font-weight: 700;
  cursor: pointer;
  font-size: 0.95rem;
  line-height: 1.2;
  position: relative;
  top: 1px;                  /* ğŸ‘ˆ å‘ä¸‹å¾®è°ƒ 1pxï¼Œä¸å·¦ä¾§æ–‡å­—å±…ä¸­çº¿é½å¹³ */
}

.hidden {
  display: none !important;
}
  
.promo-input-row {
  display: flex;
  gap: 0.6rem;
  align-items: center;
}
.promo-input-row input {
  flex: 1;
  padding: 0.75rem 1rem;
  border-radius: 6px;
  border: 1px solid #ddd;
  text-transform: uppercase;
  font-weight: 600;
  letter-spacing: 0.5px;
  background: #fffdf7;
}
.promo-apply {
  background: var(--dark-gold);
  color: white;
  border: none;
  border-radius: 6px;
  padding: 0.8rem 1.4rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s ease;
}
.promo-apply:hover {
  background: var(--gold);
}
.promo-message {
  margin-top: 0.5rem;
  font-size: 0.85rem;
  color: #8b6b2e;
}
/* === Smooth Slide Animation === */
.promo-edit {
  border-top: 1px solid #f1e1bd;
  margin-top: 1rem;
  padding-top: 1rem;
  overflow: hidden;
  max-height: 0;
  opacity: 0;
  transform: translateY(-10px);
  transition: max-height 0.5s ease, opacity 0.4s ease, transform 0.4s ease;
}

.promo-edit.active {
  max-height: 300px; /* è‡ªåŠ¨å±•å¼€é«˜åº¦ï¼Œå¯æ ¹æ®å†…å®¹è°ƒæ•´ */
  opacity: 1;
  transform: translateY(0);
}
/* ==== Premium Result Discount Styling ==== */
.premium-price-box {
  display: flex;
  justify-content: center;
  align-items: baseline;
  gap: 0.5rem;
  font-weight: 600;
  font-size: 1rem;
  background: #fffaf0;
  border-radius: 6px;
  padding: 0.4rem 1rem;
  margin: 0.4rem auto;
  width: fit-content; /* âœ… ä¿è¯å®½åº¦åˆšå¥½åŒ…ä½å†…å®¹ */
}

.premium-price-box .old-price {
  text-decoration: line-through;
  color: #9a9480;
  opacity: 0.8;
  transition: color 0.3s ease, opacity 0.3s ease;
}

.premium-price-box .new-price {
  color: #d97706;
  font-weight: 700;
  font-size: 1.05rem;
  transition: color 0.3s ease;
}

.discount-note {
  color: #166534;
  font-size: 0.9rem;
  margin-top: 0.5rem;
}

/* ==== Better paragraph spacing & section breathing ==== */
.container p {
  line-height: 1.7;            /* âœ… æå‡è¡Œè· */
  font-size: 1rem;             /* ç»Ÿä¸€å­—ä½“å¤§å° */
  color: #2c2a29;              /* ç•¥æ·±å¯¹æ¯”æ›´æ¸…æ™° */
  margin-bottom: 1.2rem;       /* æ®µè½é—´ç•™ç™½ */
}


/* âœ… é™åˆ¶è¯´æ˜åŒºæ®µæ–‡å­—å®½åº¦ã€åŠ å¼ºå¯è¯»æ€§ */
.coverage-preview p,
#overview p {
  max-width: 700px;            /* åˆé€‚é˜…è¯»å®½åº¦ */
  margin: 0 auto 1.6rem;       /* å±…ä¸­ + ä¸‹æ–¹ç•™ç™½ */
  line-height: 1.75;           /* è¡Œè·å†æ”¾æ¾ */
}

/* ==== è°ƒæ•´æ®µè½å­—è·ä¸è¡Œé«˜ï¼Œé˜…è¯»æ›´èˆ’é€‚ ==== */
#overview p,
#coverage-preview p {
  letter-spacing: 0.3px;       /* âœ… å¢åŠ ä¸€ç‚¹å­—è·ï¼Œé¿å…ç´§è´´ */
  word-spacing: 1px;           /* âœ… å•è¯é—´è·å¾®æ”¾å®½ï¼ˆè‹±æ–‡æ›´è‡ªç„¶ï¼‰ */
  line-height: 1.8;            /* âœ… å¤šä¸€ç‚¹è¡Œé«˜è®©æ®µè½æ›´é€šé€ */
  font-size: 1.0rem;         
}

/* ==== restore the original disclaimer text style (classic serif italic) ==== */
.disclaimer-bar p {
  font-size: 0.7rem;                              /* âœ… å°å·å­—ä½“ */
  line-height: 1.3;                               /* âœ… ç´§å‡‘æ®µè½ */
  color: var(--dark-gold);                        /* âœ… é‡‘æ£•è‰² */
  font-style: italic;                             /* âœ… æ–œä½“ */
  font-family: "Georgia", "Times New Roman", serif;/* âœ… åŸæ¥é‚£ç§ä¼˜é›…çš„ serif å­—ä½“ */
  margin-top: 1.5rem;
  margin-bottom: 0;
  text-align: center;
  letter-spacing: 0;                              /* âœ… ä¸è¦é¢å¤–å­—è· */
  word-spacing: 0;                                /* âœ… ç»´æŒè‡ªç„¶é—´è· */
}

/* === å·¦å¯¹é½ Aboutâ€¯&â€¯Coverage æ–‡å­— === */
#overview,
#coverage-preview {
  text-align: left; /* âœ… æ”¹ä¸ºå·¦å¯¹é½ */
}

/* æ ‡é¢˜ç»§ç»­å±…ä¸­ï¼Œä»…æ­£æ–‡å·¦å¯¹é½ */
#overview h3,
#coverage-preview h3 {
  text-align: center;
}

/* ä¿®æ­£æ­£æ–‡æ®µè½å†…çš„ marginï¼Œè®©å®ƒä¸å— auto å±…ä¸­å½±å“ */
#overview p,
#coverage-preview p {
  margin-left: 0;
  margin-right: 0;
}
  
</style>
</head>

<body>
<div id="site-header"></div>

<section class="hero">
  <h2>Protectingâ€¯Farmers,â€¯Securingâ€¯Harvests</h2>
  <h3 class="slogan">â€œLebihâ€¯Pasti,â€¯Lebihâ€¯Tenangâ€</h3>
  <p class="sub-brand">Poweredâ€¯byâ€¯<strong>AgroShieldâ€¯Incomeâ€¯Guard</strong> â€” Anâ€¯Incomeâ€¯Protectionâ€¯Planâ€¯byâ€¯TerraShieldâ€¯Insurance</p>
  <p>Estimateâ€¯ yourâ€¯ agriculturalâ€¯ insuranceâ€¯ premiumâ€¯ instantlyâ€¯ forâ€¯ yourâ€¯ cropsâ€¯ inâ€¯ Malaysia.</p>
</section>

  
<section id="calculator" class="container">
  <h3>Premium Calculator</h3>
  <div class="grid">
    <div>
      <label for="state">State</label>
      <select id="state" onchange="updateCoverageOptions()">
        <option value="">-- Select State --</option>
        <option>Johor</option><option>Kedah</option><option>Kelantan</option><option>Melaka</option>
        <option>Negeri Sembilan</option><option>Pahang</option><option>Perak</option><option>Perlis</option>
        <option>Pulau Pinang</option><option>Sabah</option><option>Sarawak</option><option>Selangor</option>
        <option>Terengganu</option><option>W.P. Kuala Lumpur</option><option>W.P Labuan</option><option>W.P. Putrajaya</option>
      </select>
    </div>
    <div>
      <label for="district">District</label>
      <input id="district" placeholder="e.g. Kota Setar" />
    </div>
    <div>
      <label for="crop">Crop</label>
      <select id="crop" onchange="updateCoverageOptions()">
        <option value="">-- Select Crop --</option>
        <option>Oil Palm</option><option>Rubber</option><option>Paddy (Rice)</option>
        <option>Cocoa</option><option>Durian</option><option>Coconut</option>
        <option>Pineapple</option><option>Mango</option>
      </select>
    </div>
    <!-- âœ… ç§»é™¤äº† Expected Yield -->
    <div>
      <label for="area">Area (ha)</label>
      <input id="area" type="number" value="10" step="0.1" />
    </div>
    <div>
      <label for="trigger">Trigger Level</label>
      <select id="trigger" onchange="updateCoverageLevel()">
        <option value="">Select crop/state first</option>
      </select>
    </div>
    <div>
      <label for="coverage">Coverage Level</label>
      <input id="coverage" type="text" readonly placeholder="Autoâ€‘calculated" />
    </div>
  </div>
  <button onclick="calculatePremium()">Calculate</button>
  <div id="promoNotice" style="display:none;background:#e8f9ee;border-left:5px solid #16a34a;
    border-radius:6px;padding:0.75rem 1rem;margin-top:1.2rem;
    color:#166534;font-weight:500;animation:fadeInPromo 0.5s ease;">
    <span style="margin-right:6px;"></span>
    <span id="promoNoticeText"></span>
  </div>
  <div id="resultBox"></div>
  <div class="disclaimer-bar">
  <p>
  The above premiums are calculated at the standard premium rate and are for reference only.
  The actual premiums paid must include the premium levy collected by the Insurance Authority.
  </p>
  </div>

</section>
<!-- Promo Section -->
<div id="promoContainer" class="promo-card">
  <!-- å±•ç¤ºæ¨¡å¼ -->
  <div id="promoDisplay" class="promo-display">
    <div class="promo-text">
      <span id="promoStatusText">No promo code applied.</span>
    </div>
    <button class="promo-edit-btn" onclick="togglePromoEdit(true)">Editâ€¯Promoâ€¯Code</button>
  </div>

  <!-- ç¼–è¾‘æ¨¡å¼ -->
  <div id="promoEdit" class="promo-edit">
    <div class="promo-edit-header">
      <span>ğŸŸï¸â€¯Enterâ€¯yourâ€¯Promoâ€¯Code</span>
      <button class="promo-cancel" onclick="togglePromoEdit(false)">Cancel</button>
    </div>
    <div class="promo-input-row">
      <input id="promoInput" placeholder="e.g.â€¯WELCOME" />
      <button class="promo-apply" onclick="applyPromo()">Apply</button>
    </div>
    <div id="promoMessage" class="promo-message"></div>
  </div>
</div>
  
<!-- â¬‡ï¸ æ”¾åœ¨ Footer ä¸Šæ–¹ -->
<section id="overview" class="container">
  <h3>Aboutâ€¯TerraShield</h3>
  <p>
    TerraShieldâ€¯ empowersâ€¯ Malaysianâ€¯ farmersâ€¯ withâ€¯ reliable,â€¯ dataâ€‘driven â€¯insuranceâ€¯ tools â€¯to â€¯make
    cropâ€¯ protectionâ€¯ transparent â€¯andâ€¯ affordable â€¯for â€¯sustainableâ€¯ growth.
  </p>
</section>

<section id="coverage-preview" class="container coverage-preview">
  <h3>Cropâ€¯&â€¯Riskâ€¯Coverageâ€¯Overview</h3>
  <p>
    Learnâ€¯ which  crops â€¯andâ€¯ risks â€¯are â€¯included â€¯inâ€¯ ourâ€¯ Malaysian â€¯Agricultural â€¯Insuranceâ€¯ ProgramÂ â€”
    from â€¯rice,â€¯ durian, â€¯and â€¯oilâ€¯ palmâ€¯ to â€¯protection â€¯from â€¯floods,â€¯ droughts,â€¯ and â€¯typhoons.
  </p>
  <a class="coverage-btn" href="./coverage.html">Viewâ€¯Fullâ€¯CoverageÂ â†’</a>
</section>

<section id="contact" class="container">
  <h3>Contactâ€¯Us</h3>
  <p>
    Email:â€¯<a href="mailto:info@terrashield.my">info@terrashield.my</a><br/>
    Kualaâ€¯Lumpur,â€¯Malaysia
  </p>
</section>

<footer>Â©â€¯2025â€¯TerraShieldâ€¯Agricultureâ€¯Insuranceâ€¯|â€¯Allâ€¯Rightsâ€¯Reserved</footer>

<script>
fetch('./header.html?v=20251125')
  .then(r=>r.text())
  .then(h=>{document.getElementById('site-header').innerHTML=h;
    const p=location.pathname.split("/").pop()||"index.html";
    document.querySelectorAll("nav a").forEach(a=>{if(a.href.includes(p))a.classList.add("active");});
  }).catch(console.error);

/* ===== Coverage limits (for dropdown) ===== */
const coverageLimits = {
  "Oil Palm": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Durian": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,80], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Rubber": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Selangor":[50,70], "Terengganu":[50,70],
    "Sabah":[50,80], "Sarawak":[50,80], "W.P. Kuala Lumpur":[50,70],
    "W.P Labuan":[50,70], "W.P. Putrajaya":[50,70]
  },

  "Paddy (Rice)": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,80], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Pineapple": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,90],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Cocoa": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Coconut": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Mango": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  }
};

/* === å…¨éƒ¨ä½œç‰©çš„ Gross Premium è¡¨æ ¼ === */
const grossPremiumTable={
"Oil Palm":{"Johor":2409.15,"Kedah":2329.09,"Kelantan":2553.99,"Melaka":2393.86,"Negeri Sembilan":2249.02,
"Pahang":2553.99,"Perak":2329.09,"Perlis":2393.86,"Pulau Pinang":2538.69,"Sabah":2698.82,"Sarawak":2618.76,
"Selangor":2473.92,"Terengganu":2409.15,"W.P. Kuala Lumpur":2538.69,"W.P Labuan":2538.69,"W.P. Putrajaya":2538.69},
"Rubber":{"Johor":488.44,"Kedah":472.21,"Kelantan":517.80,"Melaka":485.34,"Negeri Sembilan":455.97,"Pahang":517.80,
"Perak":501.57,"Perlis":485.34,"Pulau Pinang":514.70,"Sabah":547.17,"Sarawak":530.94,"Selangor":501.57,
"Terengganu":488.44,"W.P. Kuala Lumpur":514.70,"W.P Labuan":514.70,"W.P. Putrajaya":514.70},
"Paddy (Rice)": {"Johor":1800,"Kedah":1650,"Kelantan":1720,"Melaka":1680,"Negeri Sembilan":1600,"Pahang":1750,
"Perak":1670,"Perlis":1650,"Pulau Pinang":1690,"Sabah":1820,"Sarawak":1790,"Selangor":1710,
"Terengganu":1680,"W.P. Kuala Lumpur":1690,"W.P Labuan":1690,"W.P. Putrajaya":1690},
"Cocoa": {"Johor":9100,"Kedah":8700,"Kelantan":9000,"Melaka":9050,"Negeri Sembilan":8650,"Pahang":8900,
"Perak":8800,"Perlis":8750,"Pulau Pinang":8990,"Sabah":9300,"Sarawak":9200,"Selangor":8780,
"Terengganu":8890,"W.P. Kuala Lumpur":8990,"W.P Labuan":8990,"W.P. Putrajaya":8990},
"Durian": {"Johor":5200,"Kedah":5000,"Kelantan":5100,"Melaka":5050,"Negeri Sembilan":4900,"Pahang":5300,
"Perak":5150,"Perlis":5000,"Pulau Pinang":5180,"Sabah":5400,"Sarawak":5350,"Selangor":5200,
"Terengganu":5050,"W.P. Kuala Lumpur":5180,"W.P Labuan":5180,"W.P. Putrajaya":5180},
"Coconut": {"Johor":1450,"Kedah":1350,"Kelantan":1420,"Melaka":1390,"Negeri Sembilan":1300,"Pahang":1400,
"Perak":1380,"Perlis":1350,"Pulau Pinang":1410,"Sabah":1500,"Sarawak":1480,"Selangor":1420,
"Terengganu":1390,"W.P. Kuala Lumpur":1410,"W.P Labuan":1410,"W.P. Putrajaya":1410},
"Pineapple": {"Johor":1250,"Kedah":1200,"Kelantan":1210,"Melaka":1220,"Negeri Sembilan":1150,"Pahang":1230,
"Perak":1200,"Perlis":1180,"Pulau Pinang":1210,"Sabah":1300,"Sarawak":1280,"Selangor":1220,
"Terengganu":1200,"W.P. Kuala Lumpur":1210,"W.P Labuan":1210,"W.P. Putrajaya":1210},
"Mango": {"Johor":2600,"Kedah":2500,"Kelantan":2550,"Melaka":2480,"Negeri Sembilan":2450,"Pahang":2520,
"Perak":2490,"Perlis":2470,"Pulau Pinang":2550,"Sabah":2650,"Sarawak":2630,"Selangor":2500,
"Terengganu":2480,"W.P. Kuala Lumpur":2550,"W.P Labuan":2550,"W.P. Putrajaya":2550}
};
/* === æ›´æ–° Trigger Level ä¸‹æ‹‰é€‰é¡¹ === */
function updateCoverageOptions(){
  const s = document.getElementById("state").value;
  const c = document.getElementById("crop").value;
  const triggerSelect = document.getElementById("trigger");

  triggerSelect.innerHTML = "";

  if(s && c && coverageLimits[c] && coverageLimits[c][s]){
    const [min,max] = coverageLimits[c][s];
    for(let i=min;i<=max;i+=5){
      const o = document.createElement("option");
      o.value = i / 100;
      o.textContent = i + "%";
      triggerSelect.appendChild(o);
    }
  } else {
    const o=document.createElement("option");
    o.textContent="Select crop and state first";
    triggerSelect.appendChild(o);
  }

  // æ¸…ç©º Coverage Level input
  document.getElementById("coverage").value="";
}

/* === å½“ Trigger Level æ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®— Coverage Level (Trigger +20%) === */
function updateCoverageLevel(){
  const triggerVal = parseFloat(document.getElementById("trigger").value);
  if(!isNaN(triggerVal)){
    const coverage = Math.min(triggerVal + 0.20, 1.0); // ä¸è¶…è¿‡100%
    document.getElementById("coverage").value = (coverage*100).toFixed(0) + "%";
    document.getElementById("coverage").dataset.value = coverage;
  } else {
    document.getElementById("coverage").value = "";
    document.getElementById("coverage").dataset.value = "";
  }
}
/* === Promo Code åˆ—è¡¨ === */
const promoCodes = {
  "WELCOME": 0.3,
};

let activePromo = { code: null, rate: 0 };

function togglePromoEdit(isEdit) {
  const display = document.getElementById("promoDisplay");
  const edit = document.getElementById("promoEdit");

  if (isEdit) {
    display.classList.add("hidden");
    edit.classList.add("active");
  } else {
    display.classList.remove("hidden");
    edit.classList.remove("active");
  }
}


function applyPromo() {
  const code = document.getElementById("promoInput").value.trim().toUpperCase();
  const message = document.getElementById("promoMessage");
  const displayText = document.getElementById("promoStatusText");

  if (!code) {
    message.textContent = "Please enter a promo code.";
    message.style.color = "red";
    return;
  }

  if (promoCodes[code]) {
    activePromo = { code, rate: promoCodes[code] };
    message.textContent = `Promo code ${code} applied (${(promoCodes[code] * 100).toFixed(0)}% off)`;
    message.style.color = "green";
    displayText.textContent = `${(promoCodes[code] * 100).toFixed(0)}% off first-year premium. Promo code ${code} applied.`;

    togglePromoEdit(false);

    // âœ… æˆåŠŸåè‡ªåŠ¨è§¦å‘è®¡ç®—ï¼š
    const crop = document.getElementById("crop").value;
    const state = document.getElementById("state").value;
    const area = parseFloat(document.getElementById("area").value);
    const trigger = parseFloat(document.getElementById("trigger").value);
    const coverage = parseFloat(document.getElementById("coverage").dataset.value);

    // å…ˆç¡®è®¤ç”¨æˆ·èµ„æ–™å®Œæ•´ï¼Œé˜²æ­¢ç©ºç®—
    if (crop && state && !isNaN(trigger) && !isNaN(coverage) && !isNaN(area)) {
      calculatePremium();  // âœ… è‡ªåŠ¨è®¡ç®—
    }

  } else {
    message.textContent = "Invalid promo code.";
    message.style.color = "red";
    activePromo = { code: null, rate: 0 };
  }
}
/* === æ ¸ç®—ä¿è´¹ === */
function calculatePremium(){
  const crop = document.getElementById("crop").value;
  const state = document.getElementById("state").value;
  const area = parseFloat(document.getElementById("area").value);
  const trigger = parseFloat(document.getElementById("trigger").value);
  const coverage = parseFloat(document.getElementById("coverage").dataset.value);
  
  if(!crop || !state || isNaN(trigger) || isNaN(coverage)){
    alert("Please fill all required fields.");return;
  }

  const gross = grossPremiumTable[crop]?.[state];
  if(!gross){alert("No Gross Premium data for this crop/state.");return;}

  const premiumPerHa = gross * coverage;
  const totalPremium = premiumPerHa * area;
  const discountRate = activePromo.rate;
  const discountedTotal = totalPremium * (1 - discountRate);

  // âœ… æ›´æ–°æç¤ºæ¡
  const promoNotice = document.getElementById("promoNotice");
  const promoNoticeText = document.getElementById("promoNoticeText");
  
  if (discountRate > 0) {
    promoNoticeText.innerHTML =
      `âœ” Promo code <strong>${activePromo.code}</strong> applied â€” ${(discountRate * 100).toFixed(0)}% off total premium.`;
    promoNotice.style.display = "block";
    promoNotice.style.opacity = "1";
    promoNotice.style.transition = "none"; // ä¸æ·¡å‡ºã€ä¸éšè—
  } else {
    // æ²¡æœ‰æ´»åŠ¨æŠ˜æ‰£ï¼šéšè—æç¤ºæ¡
    promoNotice.style.display = "none";
    promoNoticeText.textContent = "";
  }


  const r = document.getElementById("resultBox");
  r.style.display = "block";
  r.innerHTML = `
    <strong>${crop}</strong> (${state})<br>
    Triggerâ€¯Level: ${(trigger*100).toFixed(0)}%<br>
    Coverageâ€¯Levelâ€¯: ${(coverage*100).toFixed(0)}%<br>
    â€¯Estimatedâ€¯Premiumâ€¯(perâ€¯ha):â€¯<strong>RMâ€¯${premiumPerHa.toLocaleString(undefined,{maximumFractionDigits:2})}</strong><br>
    <div class="premium-price-box" style="margin-top:0.4rem;">
    â€¯Totalâ€¯Premiumâ€¯forâ€¯${area}â€¯ha:â€¯
      ${discountRate>0
        ? `<span class="old-price">RMâ€¯${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</span>
           <span class="new-price">â†’â€¯RMâ€¯${discountedTotal.toLocaleString(undefined,{maximumFractionDigits:2})}</span>`
        : `<strong>RMâ€¯${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</strong>`}
    </div>
    ${discountRate>0?`<div class="discount-note">ğŸŸï¸â€¯Promo <strong>${activePromo.code}</strong> appliedâ€¯(${(discountRate*100).toFixed(0)}%â€¯off)</div>`:""}
  `;
}
</script>
</body>
</html>
