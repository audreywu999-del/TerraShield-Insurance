<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TerraShield Agriculture Insurance</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<style>
:root {
  --gold: #E3A008;
  --dark-gold: #D97706;
  --light-cream: #FFF8E5;
  --text-dark: #2C2A29;
  --bg: #FFFCF7;
}

/* ====== Global Base ====== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Poppins', sans-serif;
}

html { scroll-behavior: smooth; }
body { background: var(--bg); color: var(--text-dark); }

header {
  background: linear-gradient(90deg, var(--gold), var(--dark-gold));
  color: white;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 10;
}

.logo-box { display: flex; align-items: center; gap: 10px; }
.logo { height: 48px; width: auto; }
header h1 { font-size: 1.3rem; letter-spacing: .5px; }

nav a {
  color: white;
  text-decoration: none;
  margin-left: 1.2rem;
  font-weight: 500;
  position: relative;
  padding-bottom: 4px;
  transition: color 0.3s ease;
}
nav a:hover { color: var(--light-cream); }
nav a.active {
  color: var(--light-cream);
  font-weight: 600;
}
nav a.active::after {
  content: "";
  position: absolute;
  left: 0; bottom: 0;
  width: 100%; height: 2px;
  background: var(--light-cream);
}

/* ===== Hero Section ===== */
.hero {
  background: linear-gradient(to right, #FFF7E0, #FFF8E5);
  text-align: center;
  padding: 4rem 1rem 3rem;
}
.hero h2 { font-size: 2.2rem; color: var(--dark-gold); }
.slogan {
  font-style: italic;
  color: var(--dark-gold);
  font-size: 1.5rem;
  font-weight: 500;
  margin-top: .3rem;
  margin-bottom: 1rem;
  opacity: 0;
  transform: translateY(10px);
  animation: fadeInSlogan 1.8s ease forwards;
  animation-delay: .5s;
}
@keyframes fadeInSlogan { to { opacity: 1; transform: translateY(0); } }
.sub-brand {
  font-size: .95rem;
  color: #8b6b2e;
  font-style: italic;
  margin-top: .5rem;
  margin-bottom: 1.2rem;
  opacity: 0;
  transform: translateY(8px);
  animation: fadeInSub 1.6s ease forwards;
  animation-delay: .6s;
  border-top: 1px solid #f3e1b2;
  display: inline-block;
  padding-top: .4rem;
}
@keyframes fadeInSub {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}


/* ===== Containers ===== */
.container {
  max-width: 900px;
  background: white;
  margin: 3rem auto;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.08);
}
h3 { text-align: center; color: var(--dark-gold); margin-bottom: 1.2rem; }

/* ===== Premium Calculator Grid ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 1rem;
}
label { display: block; font-size: .9rem; margin-bottom: .3rem; }
select, input {
  width: 100%;
  padding: .8rem;
  border-radius: 6px;
  border: 1px solid #ddd;
}
button {
  display: block;
  background: var(--dark-gold);
  color: white;
  border: none;
  margin: 1.5rem auto 0;
  padding: .9rem 2.2rem;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.05rem;
}
button:hover {
  background: var(--gold);
  transform: translateY(-2px);
  transition: .2s;
}

/* ===== Result Box ===== */
#resultBox {
  display: none;
  background: var(--light-cream);
  text-align: center;
  margin-top: 1rem;
  padding: 1rem;
  border-radius: 8px;
  color: var(--dark-gold);
  font-weight: 500;
}

/* ===== Promo Card ===== */
.promo-card {
  max-width: 900px;
  margin: 2.5rem auto;
  background: #ffffff;
  border: 1px solid #f1e1bd;
  border-radius: 12px;
  padding: 1.4rem 1.8rem;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
}
.promo-card:hover {
  box-shadow: 0 5px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-2px);
}
.promo-display {
  display: flex;
  justify-content: space-between;   /* Â∑¶ÊñáÂ≠óÂè≥ÊåâÈíÆ */
  align-items: baseline;            /* ‚úÖ ÂØπÈΩêÂà∞ÊñáÂ≠óÁöÑÂ∫ïÁ∫ø */
  padding: 0.9rem 1.2rem;
}

.promo-text {
  color: #4b3b08;
  font-weight: 600;
  font-size: 1.05rem;
  line-height: 1.4;                 /* ‚úÖ Á°Æ‰øùÊñáÂ≠óÊúâÊ†áÂáÜË°åÈ´ò */
}

.promo-edit-btn {
  background: #fff8e5;
  border: 2px solid #d97706;
  color: #d97706;
  font-weight: 700;
  font-size: 0.95rem;
  padding: 0.55rem 1.4rem;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  position: relative;
  top: -1px;                        /* ‚úÖ ÂæÆË∞ÉÔºå‰ΩøÊåâÈíÆ‰∏éÊñáÂ≠ó‰∏≠ÂøÉÂÆåÁæéÂØπÈΩê */
  transition: all 0.25s ease;
}
.promo-edit-btn:hover {
  background: var(--dark-gold);
  color: #fff;
}
.promo-banner {
  display: none;
  background: #ebf7ee;               /* ÊüîÂíåÁªøÂ∫ï */
  border-left: 5px solid #16a34a;    /* Ê∑±ÁªøÁ∫ø */
  border-radius: 6px;
  padding: 0.75rem 1rem;
  margin-top: 1.2rem;
  color: #166534;
  font-weight: 500;
  animation: fadeInPromo 0.5s ease;
}
/* ===== Coverage / Overview Section ===== */
#overview,
#coverage-preview {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;               /* ‚úÖ ÊñáÊú¨Â∑¶ÂØπÈΩê */
}
#coverage-preview { background: #fff9ee; } /* ‰øùÊåÅÊ∑°ÈªÑËâ≤ËÉåÊôØ */
/* ‚úÖ ËÆ©ÊåâÈíÆÂ±Ö‰∏≠ */
#coverage-preview {
  text-align: center; /* Áà∂ÂÆπÂô®Â±Ö‰∏≠ÔºåÊåâÈíÆËá™Âä®Â±Ö‰∏≠ */
}

#coverage-preview p {
  text-align: left; /* ÊÆµËêΩ‰ªçÁÑ∂Â∑¶ÂØπÈΩê */
}
#overview h3,
#coverage-preview h3 {
  text-align: center;
  margin-bottom: 1rem;
}
#overview p,
#coverage-preview p {
  font-size: 1rem;
  line-height: 1.75;
  margin: 0 0 1.5rem 0;
  letter-spacing: 0.3px;
  word-spacing: 1px;
}
#coverage-preview .coverage-btn {
  display: inline-block;
  margin: 0 auto;
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 0.7rem 1.6rem;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 500;
  transition: background 0.3s ease;
}
#coverage-preview .coverage-btn:hover { background: var(--gold); }

/* ===== Contact Section ===== */
#contact {
  max-width: 900px;
  margin: 0 auto 3rem;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-sizing: border-box;
  text-align: left;
}
/* Force the disclaimer container to left-align */
.disclaimer-bar {
  text-align: left !important;   /* ‚úÖ Áà∂Á∫ßÂº∫Âà∂Â∑¶ÂØπÈΩê */
}
  
/* ===== Disclaimer  ===== */
.disclaimer-bar p {
  font-family: 'Poppins', sans-serif;
  font-style: italic;
  font-size: 0.9rem;
  line-height: 1.6;
  color: var(--dark-gold);
  text-align: left;
  margin-top: 1.5rem;
  margin-bottom: 0;
}

/* ===== Footer ===== */
footer {
  text-align: center;
  background: var(--dark-gold);
  color: white;
  padding: 1.2rem;
  margin-top: 4rem;
  font-size: 0.9rem;
}

/* ===== Responsive ===== */
@media(max-width:600px) {
  header { flex-direction: column; align-items: flex-start; }
  .container { padding: 1.5rem; }
  #overview, #coverage-preview, #contact, .promo-card { padding: 1.5rem; }
  .hero h2 { font-size: 1.7rem; }
  .disclaimer-bar p { font-size: 0.8rem; }
}
/* ===== Promo Edit / Input layout ===== */
.promo-edit {
  padding: 0.9rem 1.2rem;
  border-top: 1px solid #f0e3c4;
  border-radius: 8px;
  background: #fffdf8;
  margin-top: 0.8rem;
}

.promo-edit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  color: var(--dark-gold);
  font-weight: 600;
}

.promo-input-row {
  display: flex;
  gap: 0.8rem;
}

.promo-input-row input {
  flex: 1;
  padding: 0.75rem;
  font-size: 0.95rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  color: #333;
}

.promo-input-row input:focus {
  outline: none;
  border-color: var(--dark-gold);
  box-shadow: 0 0 3px rgba(217, 119, 6, 0.3);
}

.promo-apply,
.promo-cancel {
  background: var(--dark-gold);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.65rem 1.2rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s ease;
}

.promo-apply:hover,
.promo-cancel:hover {
  background: var(--gold);
}

.promo-message {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  font-weight: 500;
}

.arrow {
  font-weight: 500;
  color: #7a621f;
  margin: 0 4px;
}
/* ===== Promo Discount Styling ===== */
.old-price {
  text-decoration: line-through;
  color:  #9ca3af;            /* ÁÅ∞Ëâ≤ */
  margin-right: 0.5rem;
  opacity: 0.8;
}

.new-price {
  color: #166534;            /* ÁªøËâ≤‰ª£Ë°®ËäÇÁúÅ */
  font-weight: 700;
}
/* ===== Highlight Total Premium Line ===== */
.highlight-total {
  background-color: #fff8e1;
  border-radius: 8px;
  padding: 0.7rem 1.2rem;
  margin-top: 0.8rem;
  display: inline-block;
  font-weight: 700;
  color: #b45309;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  font-size: 1rem;
  text-align: center;
  transition: background-color 0.3s ease, transform 0.3s ease;
}
#resultBox .highlight-total {
  display: block;
  width: fit-content;
  margin: 0.8rem auto;
}
.highlight-total:hover {
  background-color: #ffefc6;
  transform: scale(1.03);
}

/* ===== Promo ËØ¥ÊòéË°åÔºàÊ∑°ÂÖ•Âä®ÊïàÔºâ ===== */
#resultBox .discount-note {
  margin-top: 0.6rem;
  font-size: 0.9rem;
  color: #166534 !important;   /* Ê∑±ÁªøËâ≤ */
  font-weight: 500;
  opacity: 0;                   /* Ëµ∑ÂßãÈÄèÊòé */
  transform: translateY(6px);   /* Ëµ∑ÂßãÂæÆ‰∏ãÁßª */
  animation: fadeInUp 0.6s ease forwards;
}

/* Hover ËΩªËâ≤ÂèòÂåñ */
#resultBox .discount-note:hover {
  color: #0f5132 !important;
}

/* Âä®ÁîªÂÖ≥ÈîÆÂ∏ß */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
  
</head>

<body>
<div id="site-header"></div>

<section class="hero">
  <h2>Protecting‚ÄØFarmers,‚ÄØSecuring‚ÄØHarvests</h2>
  <h3 class="slogan">‚ÄúLebih‚ÄØPasti,‚ÄØLebih‚ÄØTenang‚Äù</h3>
  <p class="sub-brand">Powered‚ÄØby‚ÄØ<strong>AgroShield‚ÄØIncome‚ÄØGuard</strong> ‚Äî An‚ÄØIncome‚ÄØProtection‚ÄØPlan‚ÄØby‚ÄØTerraShield‚ÄØInsurance</p>
  <p>Estimate‚ÄØ your‚ÄØ agricultural‚ÄØ insurance‚ÄØ premium‚ÄØ instantly‚ÄØ for‚ÄØ your‚ÄØ crops‚ÄØ in‚ÄØ Malaysia.</p>
</section>

  
<section id="calculator" class="container">
  <h3>Premium Calculator</h3>
  <div class="grid">
    <div>
      <label for="state">State</label>
      <select id="state" onchange="updateCoverageOptions()">
        <option value="">-- Select State --</option>
        <option>Johor</option><option>Kedah</option><option>Kelantan</option><option>Melaka</option>
        <option>Negeri Sembilan</option><option>Pahang</option><option>Perak</option><option>Perlis</option>
        <option>Pulau Pinang</option><option>Sabah</option><option>Sarawak</option><option>Selangor</option>
        <option>Terengganu</option><option>W.P. Kuala Lumpur</option><option>W.P Labuan</option><option>W.P. Putrajaya</option>
      </select>
    </div>
    <div>
      <label for="district">District</label>
      <input id="district" placeholder="e.g. Kota Setar" />
    </div>
    <div>
      <label for="crop">Crop</label>
      <select id="crop" onchange="updateCoverageOptions()">
        <option value="">-- Select Crop --</option>
        <option>Oil Palm</option><option>Rubber</option>
        <option>Cocoa</option><option>Durian</option><option>Coconut</option>
        <option>Pineapple</option><option>Mango</option>
      </select>
    </div>
    <!-- ‚úÖ ÁßªÈô§‰∫Ü Expected Yield -->
    <div>
      <label for="area">Area (ha)</label>
      <input id="area" type="number" value="10" step="0.1" />
    </div>
    <div>
      <label for="trigger">Trigger Level</label>
      <select id="trigger" onchange="updateCoverageLevel()">
        <option value="">Select crop/state first</option>
      </select>
    </div>
    <div>
      <label for="coverage">Coverage Level</label>
      <input id="coverage" type="text" readonly placeholder="Auto‚Äëcalculated" />   
    </div>
    <p style="font-size:0.9rem;color:#8b6b2e;margin-top:0.5rem;
               display:flex;align-items:center;gap:8px;
               letter-spacing:0.5px;word-spacing:1px;line-height:1.7;">
      <span style="font-size:1.1rem;">üí°</span>
      <span>
        Coverage‚ÄØis‚ÄØalways‚ÄØ<strong>20%‚ÄØhigher</strong>‚ÄØthan‚ÄØthe‚ÄØtrigger‚ÄØlevelÔºå
        this‚ÄØmeans‚ÄØonce‚ÄØyour‚ÄØloss‚ÄØreaches‚ÄØthe‚ÄØtrigger‚ÄØpoint,‚ÄØTerraShield‚ÄØwill‚ÄØcover‚ÄØup‚ÄØto‚ÄØ20%‚ÄØmore‚ÄØto‚ÄØprotect‚ÄØyou‚ÄØbetter.
      </span>
    </p>
  </div>
  <button onclick="calculatePremium()">Calculate</button>
  <div id="promoNotice" class="promo-banner">
    <span id="promoNoticeText"></span>
  </div>
  <div id="resultBox"></div>
  <div class="disclaimer-bar">
  <p>
  The above premiums are calculated at the standard premium rate and are for reference only.
  The actual premiums paid must include the premium levy collected by the Insurance Authority.
  </p>
  </div>

</section>
<!-- Promo Section -->
<div id="promoContainer" class="promo-card">
  <!-- Â±ïÁ§∫Ê®°Âºè -->
  <div id="promoDisplay" class="promo-display">
    <div class="promo-text">
      <span id="promoStatusText">No promotion code applied.</span>
    </div>
    <button class="promo-edit-btn" onclick="togglePromoEdit(true)">Edit Promo Code</button>
  </div>

  <!-- ÁºñËæëÊ®°Âºè -->
  <div id="promoEdit" class="promo-edit" style="display:none;">
    <div class="promo-edit-header">
      <span>Enter your Promotion Code</span>
    </div>
    <div class="promo-input-row">
      <input id="promoInput" placeholder="e.g.‚ÄØWELCOME" />
      <button class="promo-apply" onclick="applyPromo()">Apply</button>
    </div>
    <div id="promoMessage" class="promo-message"></div>
  </div>
</div>
  
<!-- ‚¨áÔ∏è ÊîæÂú® Footer ‰∏äÊñπ -->
<section id="overview" class="container">
  <h3>About‚ÄØTerraShield</h3>
  <p>
    TerraShield empowers Malaysian farmers‚ÄØwith reliable,‚ÄØdata‚Äëdriven‚ÄØinsurance tools to make crop protection‚ÄØ
    transparent and‚ÄØaffordable for‚ÄØsustainable‚ÄØgrowth.
  </p>
</section>

<section id="coverage-preview" class="container coverage-preview">
  <h3>Crop‚ÄØ&‚ÄØRisk‚ÄØCoverage‚ÄØOverview</h3>
  <p>
    Learn which crops and‚ÄØrisks are included in our‚ÄØMalaysian‚ÄØAgricultural‚ÄØInsurance Program¬†‚Äî from rice, 
    durian,‚ÄØand oil palm to‚ÄØprotection‚ÄØfrom floods,‚ÄØdroughts, and‚ÄØtyphoons.
  </p>
  <a class="coverage-btn" href="./coverage.html">View‚ÄØFull‚ÄØCoverage¬†‚Üí</a>
</section>

<section id="contact" class="container">
  <h3>Contact‚ÄØUs</h3>
  <p>
    Email:‚ÄØ<a href="mailto:info@terrashield.my">info@terrashield.my</a><br/>
    Kuala‚ÄØLumpur,‚ÄØMalaysia
  </p>
</section>

<footer>¬©‚ÄØ2025‚ÄØTerraShield‚ÄØAgriculture‚ÄØInsurance‚ÄØ|‚ÄØAll‚ÄØRights‚ÄØReserved</footer>

<script>
fetch('./header.html?v=20251125')
  .then(r=>r.text())
  .then(h=>{document.getElementById('site-header').innerHTML=h;
    const p=location.pathname.split("/").pop()||"index.html";
    document.querySelectorAll("nav a").forEach(a=>{if(a.href.includes(p))a.classList.add("active");});
  }).catch(console.error);

/* ===== Coverage limits (for dropdown) ===== */
const coverageLimits = {
  "Oil Palm": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Durian": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,80], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Rubber": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,90], "Pahang":[50,70], "Perak":[50,70], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Selangor":[50,70], "Terengganu":[50,70],
    "Sabah":[50,80], "Sarawak":[50,80], "W.P. Kuala Lumpur":[50,70],
    "W.P Labuan":[50,70], "W.P. Putrajaya":[50,70]
  },

  "Pineapple": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,80], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,90],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Cocoa": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Coconut": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,70],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  },

  "Mango": {
    "Johor":[50,70], "Kedah":[50,90], "Kelantan":[50,70], "Melaka":[50,90],
    "Negeri Sembilan":[50,70], "Pahang":[50,70], "Perak":[50,90], "Perlis":[50,70],
    "Pulau Pinang":[50,70], "Sabah":[50,80], "Sarawak":[50,80], "Selangor":[50,70],
    "Terengganu":[50,70], "W.P. Kuala Lumpur":[50,70], "W.P Labuan":[50,70],
    "W.P. Putrajaya":[50,70]
  }
};

/* === ÂÖ®ÈÉ®‰ΩúÁâ©ÁöÑ Gross Premium Ë°®Ê†º === */
const grossPremiumTable = {
  "Cocoa": {
      "Johor": {"70": 69.01, "75": 86.15, "80": 106.66, "85": 130.4, "90": 157.2},
      "Kedah": {"70": 68.8, "75": 85.85, "80": 106.25, "85": 129.87, "90": 156.52, "95": 186, "100": 218.09, "100": 227.42, "100": 233.81},
      "Kelantan": {"70": 69.01, "75": 86.15, "80": 106.66, "85": 130.4, "90": 157.2},
      "Melaka": {"70": 68.97, "75": 86.09, "80": 106.58, "85": 130.3, "90": 157.07},
      "Negeri Sembilan": {"70": 68.97, "75": 86.09, "80": 106.58, "85": 130.3, "90": 157.07},
      "Pahang": {"70": 69.39, "75": 86.69, "80": 107.39, "85": 131.37, "90": 158.42},
      "Perak": {"70": 68.8, "75": 85.85, "80": 106.25, "85": 129.87, "90": 156.52, "95": 186, "100": 218.09, "100": 227.42, "100": 233.81},
      "Perlis": {"70": 68.97, "75": 86.09, "80": 106.58, "85": 130.3, "90": 157.07},
      "Pulau Pinang": {"70": 69.35, "75": 86.63, "80": 107.32, "85": 131.26, "90": 158.29},
      "Sabah": {"70": 69.77, "75": 87.23, "80": 108.13, "85": 132.33, "90": 159.64, "95": 189.84, "100": 222.71},
      "Sarawak": {"70": 69.56, "75": 86.93, "80": 107.72, "85": 131.8, "90": 158.97, "95": 189.01, "100": 221.71},
      "Selangor": {"70": 69.18, "75": 86.39, "80": 106.99, "85": 130.83, "90": 157.74},
      "Terengganu": {"70": 69.01, "75": 86.15, "80": 106.66, "85": 130.4, "90": 157.2},
      "W.P Labuan": {"70": 69.35, "75": 86.63, "80": 107.32, "85": 131.26, "90": 158.29},
      "W.P. Kuala Lumpur": {"70": 69.35, "75": 86.63, "80": 107.32, "85": 131.26, "90": 158.29},
      "W.P. Putrajaya": {"70": 69.35, "75": 86.63, "80": 107.32, "85": 131.26, "90": 158.29}
      },
  "Coconut": {
      "Johor": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.81},
      "Kedah": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.77, "95": 61.95, "100": 146.42, "100": 281.99, "100": 447.84},
      "Kelantan": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.81},
      "Melaka": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.8},
      "Negeri Sembilan": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.8},
      "Pahang": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.23, "90": 35.87},
      "Perak": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.77, "95": 61.95, "100": 146.42, "100": 281.99, "100": 447.84},
      "Perlis": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.8},
      "Pulau Pinang": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.23, "90": 35.86},
      "Sabah": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.24, "90": 35.93, "95": 62.74, "100": 149.29},
      "Sarawak": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.23, "90": 35.9, "95": 62.57, "100": 148.67},
      "Selangor": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.84},
      "Terengganu": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.22, "90": 35.81},
      "W.P Labuan": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.23, "90": 35.86},
      "W.P. Kuala Lumpur": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.23, "90": 35.86},
      "W.P. Putrajaya": {"70": 29.41, "75": 29.41, "80": 29.47, "85": 30.23, "90": 35.86}
      },
  "Durian": {
      "Johor": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.41},
      "Kedah": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.33, "95": 167.01, "100": 762.38, "100": 2111.78, "100": 4158.72},
      "Kelantan": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.56},
      "Melaka": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.39},
      "Negeri Sembilan": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.39},
      "Pahang": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.56},
      "Perak": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.63, "95": 169.65, "100": 776.46},
      "Perlis": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.39},
      "Pulau Pinang": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.39},
      "Sabah": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.45, "90": 45.72, "95": 170.38, "100": 780.35},
      "Sarawak": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.63, "95": 169.65, "100": 776.46},
      "Selangor": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.48},
      "Terengganu": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.43, "90": 45.41},
      "W.P Labuan": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.55},
      "W.P. Kuala Lumpur": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.55},
      "W.P. Putrajaya": {"70": 29.41, "75": 29.41, "80": 29.44, "85": 30.44, "90": 45.55}
      },
  "Mango": {
      "Johor": {"70": 1920.94, "75": 2639.45, "80": 3475.03, "85": 4420.8, "90": 5469.01},
      "Kedah": {"70": 1910.95, "75": 2625.66, "80": 3456.82, "85": 4397.59, "90": 5440.27, "95": 6576.86, "100": 7799.43, "100": 8121.98, "100": 8340.94},
      "Kelantan": {"70": 1920.94, "75": 2639.45, "80": 3475.03, "85": 4420.8, "90": 5469.01},
      "Melaka": {"70": 1900.95, "75": 2611.87, "80": 3438.62, "85": 4374.39, "90": 5411.53, "95": 6542.08, "100": 7758.16, "100": 8079, "100": 8296.8},
      "Negeri Sembilan": {"70": 1919.03, "75": 2636.82, "80": 3471.55, "85": 4416.36, "90": 5463.52},
      "Pahang": {"70": 1939.02, "75": 2664.4, "80": 3507.96, "85": 4462.77, "90": 5521.01},
      "Perak": {"70": 1910.95, "75": 2625.66, "80": 3456.82, "85": 4397.59, "90": 5440.27, "95": 6576.86, "100": 7799.43, "100": 8121.98, "100": 8340.94},
      "Perlis": {"70": 1919.03, "75": 2636.82, "80": 3471.55, "85": 4416.36, "90": 5463.52},
      "Pulau Pinang": {"70": 1937.11, "75": 2661.77, "80": 3504.48, "85": 4458.34, "90": 5515.52},
      "Sabah": {"70": 1957.1, "75": 2689.35, "80": 3540.89, "85": 4504.74, "90": 5573, "95": 6737.46, "100": 7990.02},
      "Sarawak": {"70": 1947.1, "75": 2675.56, "80": 3522.69, "85": 4481.54, "90": 5544.26, "95": 6702.68, "100": 7948.75},
      "Selangor": {"70": 1929.03, "75": 2650.61, "80": 3489.75, "85": 4439.57, "90": 5492.27},
      "Terengganu": {"70": 1920.94, "75": 2639.45, "80": 3475.03, "85": 4420.8, "90": 5469.01},
      "W.P Labuan": {"70": 1937.11, "75": 2661.77, "80": 3504.48, "85": 4458.34, "90": 5515.52},
      "W.P. Kuala Lumpur": {"70": 1937.11, "75": 2661.77, "80": 3504.48, "85": 4458.34, "90": 5515.52},
      "W.P. Putrajaya": {"70": 1937.11, "75": 2661.77, "80": 3504.48, "85": 4458.34, "90": 5515.52}
      },
  "Oil Palm": {
      "Johor": {"70": 272.43, "75": 456.12, "80": 713.23, "85": 1049.32, "90": 1465.87},
      "Kedah": {"70": 271.14, "75": 453.86, "80": 709.61, "85": 1043.93, "90": 1458.28, "95": 1950.79, "100": 2517.1, "100": 2742.52, "100": 2901.77},
      "Kelantan": {"70": 274.75, "75": 460.2, "80": 719.76, "85": 1059.06, "90": 1479.6},
      "Melaka": {"70": 272.18, "75": 455.69, "80": 712.54, "85": 1048.29, "90": 1464.42},
      "Negeri Sembilan": {"70": 269.86, "75": 451.61, "80": 706, "85": 1038.54, "90": 1450.69, "95": 1940.58, "100": 2503.88, "100": 2728.11, "100": 2886.51},
      "Pahang": {"70": 274.75, "75": 460.2, "80": 719.76, "85": 1059.06, "90": 1479.6},
      "Perak": {"70": 271.14, "75": 453.86, "80": 709.61, "85": 1043.93, "90": 1458.28, "95": 1950.79, "100": 2517.1, "100": 2742.52, "100": 2901.77},
      "Perlis": {"70": 272.18, "75": 455.69, "80": 712.54, "85": 1048.29, "90": 1464.42},
      "Pulau Pinang": {"70": 274.51, "75": 459.77, "80": 719.07, "85": 1058.03, "90": 1478.15},
      "Sabah": {"70": 277.07, "75": 464.27, "80": 726.3, "85": 1068.81, "90": 1493.33, "95": 1997.91, "100": 2578.12},
      "Sarawak": {"70": 275.79, "75": 462.02, "80": 722.69, "85": 1063.42, "90": 1485.74, "95": 1987.71, "100": 2564.9},
      "Selangor": {"70": 273.47, "75": 457.94, "80": 716.15, "85": 1053.67, "90": 1472.01},
      "Terengganu": {"70": 272.43, "75": 456.12, "80": 713.23, "85": 1049.32, "90": 1465.87},
      "W.P Labuan": {"70": 274.51, "75": 459.77, "80": 719.07, "85": 1058.03, "90": 1478.15},
      "W.P. Kuala Lumpur": {"70": 274.51, "75": 459.77, "80": 719.07, "85": 1058.03, "90": 1478.15},
      "W.P. Putrajaya": {"70": 274.51, "75": 459.77, "80": 719.07, "85": 1058.03, "90": 1478.15}
      },
  "Pineapple": {
      "Johor": {"70": 29.48, "75": 30.38, "80": 37.77, "85": 76.38, "90": 216.53},
      "Kedah": {"70": 29.48, "75": 30.37, "80": 37.73, "85": 76.13, "90": 215.54, "95": 592.34, "100": 1392.61, "100": 2266.75, "100": 3126.12},
      "Kelantan": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.83, "90": 218.32},
      "Melaka": {"70": 29.48, "75": 30.37, "80": 37.69, "85": 75.88, "90": 214.55, "95": 589.35, "100": 1385.37, "100": 2254.86, "100": 3109.67},
      "Negeri Sembilan": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.78, "90": 218.13},
      "Pahang": {"70": 29.48, "75": 30.4, "80": 37.93, "85": 77.27, "90": 220.11, "95": 606.15, "100": 1426.05},
      "Perak": {"70": 29.48, "75": 30.37, "80": 37.73, "85": 76.13, "90": 215.54, "95": 592.34, "100": 1392.61, "100": 2266.75, "100": 3126.12},
      "Perlis": {"70": 29.48, "75": 30.38, "80": 37.77, "85": 76.33, "90": 216.34},
      "Pulau Pinang": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.78, "90": 218.13},
      "Sabah": {"70": 29.48, "75": 30.4, "80": 37.93, "85": 77.27, "90": 220.11, "95": 606.15, "100": 1426.05},
      "Sarawak": {"70": 29.48, "75": 30.39, "80": 37.89, "85": 77.03, "90": 219.12, "95": 603.16, "100": 1418.81},
      "Selangor": {"70": 29.48, "75": 30.37, "80": 37.73, "85": 76.13, "90": 215.54, "95": 592.34, "100": 1392.61, "100": 2266.75, "100": 3126.12},
      "Terengganu": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.83, "90": 218.32},
      "W.P Labuan": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.78, "90": 218.13},
      "W.P. Kuala Lumpur": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.78, "90": 218.13},
      "W.P. Putrajaya": {"70": 29.48, "75": 30.39, "80": 37.85, "85": 76.78, "90": 218.13}
      },
  "Rubber": {
      "Johor": {"70": 111.4, "75": 146.6, "80": 188.58, "85": 237.03, "90": 291.54},
      "Kedah": {"70": 110.97, "75": 145.98, "80": 187.74, "85": 235.93, "90": 290.15, "95": 349.95, "100": 414.84, "100": 433.39, "100": 446.03},
      "Kelantan": {"70": 112.19, "75": 147.72, "80": 190.1, "85": 239.01, "90": 294.04},
      "Melaka": {"70": 111.32, "75": 146.48, "80": 188.42, "85": 236.82, "90": 291.27},
      "Negeri Sembilan": {"70": 110.54, "75": 145.36, "80": 186.9, "85": 234.84, "90": 288.77, "95": 348.24, "100": 412.8, "100": 431.24, "100": 443.82},
      "Pahang": {"70": 112.19, "75": 147.72, "80": 190.1, "85": 239.01, "90": 294.04},
      "Perak": {"70": 111.75, "75": 147.1, "80": 189.26, "85": 237.92, "90": 292.66},
      "Perlis": {"70": 111.32, "75": 146.48, "80": 188.42, "85": 236.82, "90": 291.27},
      "Pulau Pinang": {"70": 112.1, "75": 147.61, "80": 189.94, "85": 238.8, "90": 293.78},
      "Sabah": {"70": 112.97, "75": 148.84, "80": 191.62, "85": 241, "90": 296.55, "95": 357.81, "100": 424.3},
      "Sarawak": {"70": 112.54, "75": 148.22, "80": 190.78, "85": 239.9, "90": 295.16, "95": 356.11, "100": 422.25},
      "Selangor": {"70": 111.75, "75": 147.1, "80": 189.26, "85": 237.92, "90": 292.66},
      "Terengganu": {"70": 111.4, "75": 146.6, "80": 188.58, "85": 237.03, "90": 291.54},
      "W.P Labuan": {"70": 112.1, "75": 147.61, "80": 189.94, "85": 238.8, "90": 293.78},
      "W.P. Kuala Lumpur": {"70": 112.1, "75": 147.61, "80": 189.94, "85": 238.8, "90": 293.78},
      "W.P. Putrajaya": {"70": 112.1, "75": 147.61, "80": 189.94, "85": 238.8, "90": 293.78}
      }
};
/* === Êõ¥Êñ∞ Trigger Level ‰∏ãÊãâÈÄâÈ°π === */
function updateCoverageOptions(){
  const s = document.getElementById("state").value;
  const c = document.getElementById("crop").value;
  const triggerSelect = document.getElementById("trigger");

  triggerSelect.innerHTML = "";

  if(s && c && coverageLimits[c] && coverageLimits[c][s]){
    const [min,max] = coverageLimits[c][s];
    for(let i=min;i<=max;i+=5){
      const o = document.createElement("option");
      o.value = i / 100;
      o.textContent = i + "%";
      triggerSelect.appendChild(o);
    }

    // üü¢ Ëá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÈÄâÈ°πÂπ∂Ëß¶Âèë coverage ËÆ°ÁÆó
    triggerSelect.selectedIndex = 0;
    updateCoverageLevel();

  } else {
    const o=document.createElement("option");
    o.textContent="Select crop and state first";
    triggerSelect.appendChild(o);
  }

  // Ê∏ÖÁ©∫ Coverage Level input
  document.getElementById("coverage").value="";
}

/* === ÂΩì Trigger Level ÊîπÂèòÊó∂Ëá™Âä®ËÆ°ÁÆó Coverage Level (Trigger +20%) === */
function updateCoverageLevel(){
  const triggerVal = parseFloat(document.getElementById("trigger").value);
  if(!isNaN(triggerVal)){
    const coverage = Math.min(triggerVal + 0.20, 1.0); // ‰∏çË∂ÖËøá100%
    document.getElementById("coverage").value = (coverage*100).toFixed(0) + "%";
    document.getElementById("coverage").dataset.value = coverage;
  } else {
    document.getElementById("coverage").value = "";
    document.getElementById("coverage").dataset.value = "";
  }
}
/* === Promo Code ÂàóË°® === */
const promoCodes = {
  "WELCOME": 0.3,
};

let activePromo = { code: null, rate: 0 };

function togglePromoEdit(isEdit) {
  const display = document.getElementById("promoDisplay");
  const edit = document.getElementById("promoEdit");

  if (isEdit) {
    display.style.display = "none";
    edit.style.display = "block";
  } else {
    display.style.display = "flex";
    edit.style.display = "none";
  }
}


function applyPromo() {
  const code = document.getElementById("promoInput").value.trim().toUpperCase();
  const message = document.getElementById("promoMessage");
  const displayText = document.getElementById("promoStatusText");

  if (!code) {
    message.textContent = "Please enter a promo code.";
    message.style.color = "red";
    return;
  }

  if (promoCodes[code]) {
    activePromo = { code, rate: promoCodes[code] };
    message.textContent = `Promo code ${code} applied (${(promoCodes[code] * 100).toFixed(0)}% off)`;
    message.style.color = "green";
    displayText.textContent = `${(promoCodes[code] * 100).toFixed(0)}% off first-year premium. Promo code ${code} applied.`;

    togglePromoEdit(false);

    // ‚úÖ ÊàêÂäüÂêéËá™Âä®Ëß¶ÂèëËÆ°ÁÆóÔºö
    const crop = document.getElementById("crop").value;
    const state = document.getElementById("state").value;
    const area = parseFloat(document.getElementById("area").value);
    const trigger = parseFloat(document.getElementById("trigger").value);
    const coverage = parseFloat(document.getElementById("coverage").dataset.value);

    // ÂÖàÁ°ÆËÆ§Áî®Êà∑ËµÑÊñôÂÆåÊï¥ÔºåÈò≤Ê≠¢Á©∫ÁÆó
    if (crop && state && !isNaN(trigger) && !isNaN(coverage) && !isNaN(area)) {
      calculatePremium();  // ‚úÖ Ëá™Âä®ËÆ°ÁÆó
    }

  } else {
    message.textContent = "Invalid promo code.";
    message.style.color = "red";
    activePromo = { code: null, rate: 0 };
  }
}
/* === Ê†∏ÁÆó‰øùË¥π === */
function calculatePremium(){
  const crop = document.getElementById("crop").value;
  const state = document.getElementById("state").value;
  const area = parseFloat(document.getElementById("area").value);
  const trigger = parseFloat(document.getElementById("trigger").value);
  const coverage = parseFloat(document.getElementById("coverage").dataset.value);
  
  if(!crop || !state || isNaN(trigger) || isNaN(coverage)){
    alert("Please fill all required fields.");
    return;
  }

  // ‚úÖ Êñ∞Ê†ºÂºèÔºöÊåâ trigger level Êü•Êâæ
  const triggerPct = Math.round(trigger * 100).toString();
  const grossData = grossPremiumTable[crop]?.[state];
  
  if(!grossData){
    alert("No data for this crop/state.");
    return;
  }
  
  const gross = grossData[triggerPct];
  
  if(gross === undefined){
    alert(`No premium data for ${crop} in ${state} at ${triggerPct}% trigger level.`);
    return;
  }

  const totalPremium = gross * area;
  const discountRate = activePromo.rate;
  const discountedTotal = totalPremium * (1 - discountRate);

  // Êõ¥Êñ∞ÊèêÁ§∫Êù°
  const promoNotice = document.getElementById("promoNotice");
  const promoNoticeText = document.getElementById("promoNoticeText");
  
  if (discountRate > 0) {
    promoNoticeText.innerHTML =
      `‚úî Promo code <strong>${activePromo.code}</strong> applied ‚Äî ${(discountRate * 100).toFixed(0)}% off total premium.`;
    promoNotice.style.display = "block";
  } else {
    promoNotice.style.display = "none";
  }

  const r = document.getElementById("resultBox");
  r.style.display = "block";
  r.innerHTML = `
    <strong>TOTAL PREMIUM CALCULATOR</strong><br>
    <strong>${crop}</strong> (${state})<br>
    Trigger Level: ${triggerPct}%<br>
    Coverage Level: ${(coverage*100).toFixed(0)}%<br>
    Gross Premium (per ha): <strong>RM ${gross.toLocaleString(undefined,{maximumFractionDigits:2})}</strong><br>
    <div class="highlight-total">
      Total‚ÄØPremium‚ÄØfor‚ÄØ${area}‚ÄØha:&nbsp;
      ${
        discountRate > 0
          ? `<span class="old-price">RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</span>
             <span class="arrow">‚Üí</span>
             <span class="new-price">RM¬†${discountedTotal.toLocaleString(undefined,{maximumFractionDigits:2})}</span>`
          : `<strong>RM¬†${totalPremium.toLocaleString(undefined,{maximumFractionDigits:2})}</strong>`
      }
    </div>
    ${discountRate>0?`<div class="discount-note">Promo <strong>${activePromo.code}</strong> applied (${(discountRate*100).toFixed(0)}% off)</div>`:""}
  `;
}
</script>
</body>
</html>
